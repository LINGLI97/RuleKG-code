#################### parameter settings ####################
dataset:alibaba-fashion
data_path:data/
load_rules:True
which_rule:8
epoch:500
batch_size:1024
test_batch_size:1024
dim:64
l2:1e-05
lr:0.0001
sim_regularity:0.0001
inverse_r:True
node_dropout:True
node_dropout_rate:0.5
mess_dropout:True
mess_dropout_rate:0.1
batch_test_flag:True
channel:64
cuda:True
gpu_id:0
edge_threshold:64
adj_epoch:1
in_channel:[64, 32]
out_channel:[32, 64]
description:file_orgnode2
pretrain_s:False
pretrain_r:False
freeze_s:False
k_step:3
num_sample:32
gamma:0.99
Ks:[20, 40, 60, 80, 100]
test_flag:part
n_factors:4
ind:distance
context_hops:3
save:True
out_dir:./weights/
rank:[20, 40, 60, 80, 100]
flag_step:10
#################### experimental settings ####################
0) Model: KGIN
1) recommender: GCN
2) sampler: random sampling
#################### start training ####################
Epoch:0/500, one epoch(train+test/hour): 0.23565448145071666, training time: 590.8421921730042, testing time: 257.5139367580414
recall    : [0.04306845 0.06826827 0.08770577 0.10449383 0.11962546]
ndcg      : [0.02503006 0.03204864 0.03675696 0.04051749 0.0437073 ]
precision : [0.00632583 0.00501011 0.00429712 0.00384943 0.00352608]
hit_ratio : [0.11794854 0.17976431 0.22416498 0.26106094 0.29304965]
Epoch:3/500, one epoch(train+test/hour): 0.23410069485505422, training time: 585.7221119403839, testing time: 257.04038166999817
recall    : [0.06073366 0.09345367 0.11854431 0.13975138 0.15792618]
ndcg      : [0.03617032 0.0452942  0.0513756  0.05610426 0.05994772]
precision : [0.00884527 0.00682571 0.00578847 0.00512092 0.00463723]
hit_ratio : [0.16176522 0.2375183  0.29080085 0.33331881 0.36824489]
Epoch:6/500, one epoch(train+test/hour): 0.23335317280557422, training time: 583.6160087585449, testing time: 256.4554080963135
recall    : [0.07361817 0.1100634  0.13734091 0.15993105 0.17927147]
ndcg      : [0.04396528 0.05416741 0.06078425 0.0658209  0.06990106]
precision : [0.01070532 0.0080547  0.00671385 0.0058667  0.00526532]
hit_ratio : [0.19153999 0.27310683 0.32891709 0.37228924 0.40729377]
Epoch:9/500, one epoch(train+test/hour): 0.2330971802605523, training time: 583.6757619380951, testing time: 255.47407150268555
recall    : [0.08885402 0.13015821 0.16040559 0.18520008 0.20615775]
ndcg      : [0.05341201 0.06497117 0.0723141  0.07786415 0.08229941]
precision : [0.01297155 0.00954584 0.00786077 0.00681917 0.0060809 ]
hit_ratio : [0.22740743 0.31446552 0.37340492 0.41779688 0.45336797]
Epoch:12/500, one epoch(train+test/hour): 0.23231445451577504, training time: 581.7171804904938, testing time: 254.61484670639038
recall    : [0.09972243 0.14670325 0.18109422 0.20842327 0.23122993]
ndcg      : [0.05907055 0.07224313 0.08059865 0.08673758 0.09157334]
precision : [0.01445898 0.01072624 0.00886154 0.00767315 0.00682414]
hit_ratio : [0.24958162 0.34722997 0.41088488 0.45769123 0.49388118]
Epoch:15/500, one epoch(train+test/hour): 0.4060301160812378, training time: 1186.113289117813, testing time: 275.595116853714
recall    : [0.10547961 0.15574876 0.19296478 0.22164444 0.24623766]
ndcg      : [0.06188307 0.07595083 0.084981   0.09143175 0.09665278]
precision : [0.01524824 0.0113525  0.00940558 0.0081362  0.00724958]
hit_ratio : [0.26260372 0.36494143 0.43108918 0.47901994 0.51708389]
Epoch:18/500, one epoch(train+test/hour): 0.37336064285702175, training time: 1149.0878665447235, testing time: 195.01044416427612
recall    : [0.10820477 0.16045815 0.19770063 0.22856369 0.25442397]
ndcg      : [0.06325995 0.0778563  0.08690474 0.09380795 0.09927654]
precision : [0.01563045 0.01167217 0.00963104 0.00837001 0.00746566]
hit_ratio : [0.26839133 0.37322188 0.44009309 0.49029008 0.52873754]
Epoch:21/500, one epoch(train+test/hour): 0.3931328787406286, training time: 1140.1851773262024, testing time: 275.0931816101074
recall    : [0.10978946 0.16266914 0.20114788 0.23241916 0.2583231 ]
ndcg      : [0.06440327 0.07916049 0.088498   0.09548799 0.10097293]
precision : [0.01586927 0.01182187 0.00978256 0.00849727 0.00757252]
hit_ratio : [0.27151175 0.37740569 0.44507008 0.49667039 0.53571927]
Epoch:24/500, one epoch(train+test/hour): 0.3926677113109165, training time: 1142.8722870349884, testing time: 270.73146533966064
recall    : [0.11161312 0.16426193 0.20311123 0.23474492 0.26090993]
ndcg      : [0.06554541 0.08025389 0.08968343 0.09675885 0.10229508]
precision : [0.01611943 0.0119463  0.00988803 0.00859141 0.00765402]
hit_ratio : [0.27552123 0.3801949  0.44864375 0.49996513 0.53924064]
Epoch:27/500, one epoch(train+test/hour): 0.39974496848053404, training time: 1167.4045310020447, testing time: 271.6773431301117
recall    : [0.11330546 0.16676702 0.20595883 0.23752677 0.26427054]
ndcg      : [0.0666017  0.08153765 0.09103929 0.09812958 0.1037811 ]
precision : [0.01636    0.01212193 0.01001368 0.00869709 0.00775373]
hit_ratio : [0.27856321 0.38455303 0.45335053 0.50413151 0.54412175]
Epoch:30/500, one epoch(train+test/hour): 0.40020222458574506, training time: 1165.763850927353, testing time: 274.964152097702
recall    : [0.11399378 0.16827783 0.20789506 0.23937349 0.26607717]
ndcg      : [0.06709438 0.08223577 0.09186329 0.09890402 0.10454286]
precision : [0.01647026 0.0122213  0.0101161  0.00875713 0.00779932]
hit_ratio : [0.28013214 0.38688027 0.45719441 0.5073391  0.54665818]
Epoch:33/500, one epoch(train+test/hour): 0.39944681617948746, training time: 1164.9303605556488, testing time: 273.07816982269287
recall    : [0.11506647 0.16979394 0.20931516 0.24088703 0.2678178 ]
ndcg      : [0.06792946 0.08320585 0.09280844 0.09986343 0.10557302]
precision : [0.01661713 0.01233853 0.0101867  0.00880921 0.00785554]
hit_ratio : [0.28234607 0.3895736  0.45898124 0.50879471 0.54813123]
Epoch:36/500, one epoch(train+test/hour): 0.3953792217704985, training time: 1149.5951838493347, testing time: 273.77000427246094
recall    : [0.11659316 0.17101283 0.21074202 0.24277897 0.26994746]
ndcg      : [0.06885756 0.0840589  0.09370315 0.10087107 0.10662013]
precision : [0.01683286 0.01243267 0.0102544  0.00888384 0.00791864]
hit_ratio : [0.28559724 0.39264173 0.46116903 0.51169723 0.551487  ]
Epoch:39/500, one epoch(train+test/hour): 0.39373253981272377, training time: 1140.2840218544006, testing time: 277.1531136035919
recall    : [0.117872   0.1726023  0.21181505 0.24429127 0.27117164]
ndcg      : [0.06965192 0.0849281  0.09447108 0.10173497 0.10743069]
precision : [0.01700152 0.01253901 0.01031236 0.00894224 0.00796074]
hit_ratio : [0.28799421 0.39449829 0.46278154 0.51405062 0.55302977]
Epoch:42/500, one epoch(train+test/hour): 0.40054639763302274, training time: 1162.903733253479, testing time: 279.06329250335693
recall    : [0.11804051 0.17327985 0.21321531 0.24519371 0.27208044]
ndcg      : [0.07003746 0.08547031 0.09517429 0.10233398 0.10801786]
precision : [0.01704248 0.01259392 0.01037701 0.00897427 0.00798114]
hit_ratio : [0.28822955 0.39559654 0.46460324 0.51514887 0.55397985]
Epoch:45/500, one epoch(train+test/hour): 0.4037761076953676, training time: 1176.4099316596985, testing time: 277.18403363227844
recall    : [0.11838324 0.17329652 0.21359227 0.2457744  0.27333378]
ndcg      : [0.07013814 0.08548614 0.0952648  0.10247095 0.1083008 ]
precision : [0.0170987  0.01260895 0.01039764 0.00899878 0.00802132]
hit_ratio : [0.28867408 0.39544836 0.46530054 0.51570672 0.55543546]
Epoch:48/500, one epoch(train+test/hour): 0.40195799774593777, training time: 1169.412546634674, testing time: 277.6362135410309
recall    : [0.11913599 0.17493512 0.21453813 0.24695707 0.2744147 ]
ndcg      : [0.07086085 0.08642798 0.09605517 0.10333516 0.10913714]
precision : [0.01722029 0.01270919 0.01044078 0.00904836 0.00805592]
hit_ratio : [0.29006868 0.3986298  0.4667823  0.51774632 0.55687365]
Epoch:51/500, one epoch(train+test/hour): 0.39778380142317876, training time: 1161.0415222644806, testing time: 270.9801526069641
recall    : [0.11987038 0.17559289 0.21620754 0.24872607 0.27603488]
ndcg      : [0.07091916 0.08646074 0.09632144 0.10360303 0.109379  ]
precision : [0.01733186 0.01276062 0.01052097 0.0091036  0.00809759]
hit_ratio : [0.29145457 0.39996339 0.46937975 0.52012586 0.55970644]
Epoch:54/500, one epoch(train+test/hour): 0.39239745060602826, training time: 1138.6682994365692, testing time: 273.9625141620636
recall    : [0.12016371 0.17532693 0.21620684 0.24886963 0.27648769]
ndcg      : [0.07113107 0.0865522  0.09647888 0.10378733 0.10964294]
precision : [0.01733796 0.01274885 0.01052446 0.00910719 0.00811554]
hit_ratio : [0.29191653 0.39959731 0.4693013  0.52002998 0.55978488]
Epoch:57/500, one epoch(train+test/hour): 0.39444416668679977, training time: 1147.51465010643, testing time: 272.4843330383301
recall    : [0.120411   0.17639918 0.21732288 0.24937047 0.27656082]
ndcg      : [0.07123586 0.08688891 0.09683136 0.10399966 0.10976283]
precision : [0.01736237 0.01282032 0.01057487 0.00912321 0.00811424]
hit_ratio : [0.29240464 0.40127955 0.47136706 0.52085803 0.55993306]
Epoch:60/500, one epoch(train+test/hour): 0.39935306827227274, training time: 1165.0619533061981, testing time: 272.60908365249634
recall    : [0.12104057 0.17697254 0.21764626 0.25011014 0.27730946]
ndcg      : [0.07190591 0.087521   0.09740639 0.10469057 0.11043766]
precision : [0.01747045 0.01285737 0.01058867 0.00915884 0.00813611]
hit_ratio : [0.29373823 0.40234293 0.47171571 0.52186912 0.56101388]
Epoch:63/500, one epoch(train+test/hour): 0.4003680337137646, training time: 1164.9098591804504, testing time: 276.4150540828705
recall    : [0.12155552 0.17756888 0.21792677 0.25071906 0.27819565]
ndcg      : [0.07221854 0.08786287 0.09766853 0.10500317 0.11082456]
precision : [0.01753103 0.01289485 0.01059797 0.00916766 0.00815686]
hit_ratio : [0.29472317 0.40311868 0.4719772  0.52237466 0.56194652]
Epoch:66/500, one epoch(train+test/hour): 0.34387973136372035, training time: 1070.610957622528, testing time: 167.35606217384338
recall    : [0.12238696 0.1781306  0.21865119 0.25156432 0.27901944]
ndcg      : [0.07272329 0.08832472 0.09815304 0.10552062 0.11132896]
precision : [0.01763693 0.01295891 0.01064024 0.00920525 0.00818519]
hit_ratio : [0.29626595 0.40420821 0.47346768 0.52381284 0.56255666]
Epoch:69/500, one epoch(train+test/hour): 0.21010646058453453, training time: 597.7204456329346, testing time: 158.66280031204224
recall    : [0.12241827 0.17856539 0.21875252 0.25154335 0.27889452]
ndcg      : [0.07268962 0.08835733 0.09815281 0.10549032 0.11126915]
precision : [0.01765567 0.01296262 0.01065099 0.00920863 0.00817969]
hit_ratio : [0.29658845 0.40485322 0.47343282 0.5240569  0.56260895]
Epoch:72/500, one epoch(train+test/hour): 0.21206254959106446, training time: 596.9353315830231, testing time: 166.48984217643738
recall    : [0.12227696 0.17855126 0.21903352 0.25206014 0.27977054]
ndcg      : [0.07273653 0.08848647 0.09833746 0.10572236 0.11158261]
precision : [0.01762822 0.01298746 0.01067394 0.00923249 0.00821099]
hit_ratio : [0.29617879 0.4052716  0.47301443 0.52427481 0.56419531]
Epoch:75/500, one epoch(train+test/hour): 0.21259788552920023, training time: 598.4743218421936, testing time: 166.87805581092834
recall    : [0.12227173 0.17924179 0.2196423  0.25204946 0.279803  ]
ndcg      : [0.07271183 0.08861971 0.09844176 0.10569524 0.11155683]
precision : [0.01765654 0.01302842 0.01069413 0.00922748 0.00820672]
hit_ratio : [0.29657974 0.40613451 0.47434802 0.52466704 0.56384666]
Epoch:78/500, one epoch(train+test/hour): 0.21219917502668167, training time: 595.5544040203094, testing time: 168.36261343955994
recall    : [0.1223452  0.17935164 0.22035183 0.25278279 0.28039204]
ndcg      : [0.07290831 0.08883636 0.09880594 0.10605991 0.11190992]
precision : [0.01766308 0.01303779 0.01073089 0.00925177 0.0082292 ]
hit_ratio : [0.29675406 0.40635242 0.47501918 0.52517258 0.56499721]
Epoch:81/500, one epoch(train+test/hour): 0.2116432226366467, training time: 593.7340440750122, testing time: 168.1815447807312
recall    : [0.12250172 0.17906136 0.2205757  0.25289468 0.28077   ]
ndcg      : [0.07265471 0.08847532 0.0985447  0.10578149 0.1116755 ]
precision : [0.01768444 0.01302712 0.0107351  0.00925624 0.008236  ]
hit_ratio : [0.29678893 0.40548951 0.47505404 0.5252336  0.56518025]
Epoch:84/500, one epoch(train+test/hour): 0.20722103622224597, training time: 600.4839432239532, testing time: 145.51174521446228
recall    : [0.12276277 0.17951673 0.22024466 0.25348689 0.28109991]
ndcg      : [0.0727808  0.08864413 0.0985457  0.10597522 0.11181705]
precision : [0.01771843 0.01305566 0.01072595 0.00927618 0.00824472]
hit_ratio : [0.29732934 0.40621296 0.47508019 0.52605293 0.56549404]
Epoch:87/500, one epoch(train+test/hour): 0.20741132272614374, training time: 602.3389279842377, testing time: 144.3418219089508
recall    : [0.12281167 0.17968282 0.22062208 0.25338493 0.28164571]
ndcg      : [0.07302294 0.08889947 0.09885161 0.10618555 0.11215577]
precision : [0.01773935 0.01305653 0.01073859 0.00927313 0.00826015]
hit_ratio : [0.2974165  0.40654417 0.47602155 0.52574786 0.56606931]
Epoch:90/500, one epoch(train+test/hour): 0.2063608013921314, training time: 598.2375297546387, testing time: 144.66134357452393
recall    : [0.12274907 0.17977241 0.22086145 0.25384464 0.28167941]
ndcg      : [0.07306845 0.08897747 0.09896252 0.1063471  0.11224609]
precision : [0.01773891 0.01306503 0.01074919 0.00928969 0.00826555]
hit_ratio : [0.29745136 0.40711073 0.4760477  0.52673279 0.56635695]
