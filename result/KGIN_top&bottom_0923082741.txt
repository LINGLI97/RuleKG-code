#################### parameter settings ####################
dataset:alibaba-fashion
data_path:data/
load_rules:True
which_rules:2
epoch:500
batch_size:1024
test_batch_size:1024
dim:64
l2:1e-05
lr:0.0001
sim_regularity:0.0001
inverse_r:False
node_dropout:True
node_dropout_rate:0.5
mess_dropout:True
mess_dropout_rate:0.1
batch_test_flag:True
channel:64
cuda:True
gpu_id:0
edge_threshold:64
adj_epoch:1
in_channel:[64, 32]
out_channel:[32, 64]
pretrain_s:False
pretrain_r:False
freeze_s:False
k_step:9
num_sample:32
gamma:0.99
Ks:[20, 40, 60, 80, 100]
test_flag:part
n_factors:4
ind:distance
context_hops:3
save:True
out_dir:./weights/
rank:[20, 40, 60, 80, 100]
flag_step:30
#################### experimental settings ####################
0) Model: KGIN
1) recommender: GCN
2) sampler: random sampling
#################### start training ####################
Epoch:0/500, one epoch(train+test/hour): 0.16696535501215193, training time: 391.89721059799194, testing time: 209.17806339263916
recall    : [0.02848473 0.04587375 0.05957197 0.07142064 0.08274867]
ndcg      : [0.01695377 0.02183922 0.0251883  0.02786127 0.03026182]
precision : [0.00425615 0.00343356 0.00298024 0.00268701 0.00248963]
hit_ratio : [0.08050345 0.12619413 0.16056237 0.18914302 0.21487344]
Epoch:9/500, one epoch(train+test/hour): 0.15030777169598472, training time: 389.4273054599762, testing time: 151.6806628704071
recall    : [0.07372594 0.11370894 0.14375365 0.16856855 0.18986224]
ndcg      : [0.04221687 0.05341628 0.06072798 0.06630071 0.07081572]
precision : [0.01081515 0.00837786 0.00708487 0.00624521 0.00563629]
hit_ratio : [0.1934227  0.28156161 0.34198278 0.3892511  0.42687051]
Epoch:18/500, one epoch(train+test/hour): 0.15345608717865414, training time: 385.5943238735199, testing time: 166.84758377075195
recall    : [0.0868905  0.13289501 0.16714927 0.19500758 0.21946972]
ndcg      : [0.05000186 0.06285106 0.07115089 0.07740528 0.08256443]
precision : [0.01268435 0.00974544 0.00818399 0.0071846  0.00647096]
hit_ratio : [0.22289241 0.32068022 0.38627013 0.43590056 0.47633533]
Epoch:27/500, one epoch(train+test/hour): 0.1719179521004359, training time: 386.42418694496155, testing time: 232.4804322719574
recall    : [0.0962172  0.14440044 0.18141884 0.21085757 0.23622218]
ndcg      : [0.05609795 0.06955653 0.07851419 0.08511797 0.09048958]
precision : [0.01402491 0.0105663  0.00886197 0.0077492  0.00695942]
hit_ratio : [0.24359354 0.34320305 0.41188725 0.46190991 0.50228366]
Epoch:36/500, one epoch(train+test/hour): 0.1558695774608188, training time: 401.6098403930664, testing time: 159.5206334590912
recall    : [0.10078916 0.15074742 0.1885031  0.21918603 0.24504389]
ndcg      : [0.05884599 0.07279044 0.08193768 0.08880486 0.09427718]
precision : [0.01468604 0.01101889 0.00920423 0.00804479 0.00720923]
hit_ratio : [0.25305941 0.35574576 0.4239157  0.47508891 0.51557597]
Epoch:45/500, one epoch(train+test/hour): 0.15204858832889134, training time: 388.3626570701599, testing time: 159.0122525691986
recall    : [0.10412915 0.15494115 0.19366395 0.22459279 0.25082064]
ndcg      : [0.06114881 0.07533921 0.08472579 0.09164803 0.09718779]
precision : [0.01516936 0.01133355 0.00946412 0.00825049 0.00737989]
hit_ratio : [0.26015445 0.36300642 0.43246636 0.48349139 0.52344676]
Epoch:54/500, one epoch(train+test/hour): 0.16550264716148377, training time: 390.38245129585266, testing time: 205.42707347869873
recall    : [0.1064871  0.15791531 0.1967721  0.22881357 0.25534666]
ndcg      : [0.0623497  0.0767272  0.08615026 0.09330292 0.09891497]
precision : [0.01549927 0.01154361 0.00961492 0.0083966  0.00750889]
hit_ratio : [0.2649484  0.36809672 0.43771355 0.49031623 0.53058538]
Epoch:63/500, one epoch(train+test/hour): 0.15168165604273479, training time: 391.0385067462921, testing time: 155.01544570922852
recall    : [0.10836039 0.16032905 0.19871159 0.23085004 0.25794519]
ndcg      : [0.06379809 0.07832661 0.08765208 0.09481696 0.10054659]
precision : [0.01576904 0.01173297 0.00972663 0.00847831 0.00759047]
hit_ratio : [0.2692368  0.37209748 0.44064221 0.492443   0.53267729]
Epoch:72/500, one epoch(train+test/hour): 0.16552489585346647, training time: 423.43059635162354, testing time: 172.4590241909027
recall    : [0.10998635 0.16287249 0.20182136 0.23337077 0.26055423]
ndcg      : [0.06477314 0.07952289 0.0890021  0.09605673 0.10179588]
precision : [0.01601178 0.01188659 0.00986667 0.00857158 0.00766308]
hit_ratio : [0.27259257 0.37646433 0.44553204 0.49610383 0.53639914]
Epoch:81/500, one epoch(train+test/hour): 0.1586924937698576, training time: 417.603068113327, testing time: 153.68989992141724
recall    : [0.11099973 0.16357347 0.20289219 0.23417912 0.26145233]
ndcg      : [0.06525192 0.07993256 0.08947525 0.09648951 0.10225612]
precision : [0.01614296 0.01195545 0.00991461 0.00860437 0.00769699]
hit_ratio : [0.27463217 0.37835576 0.44710969 0.49741998 0.53768043]
Epoch:90/500, one epoch(train+test/hour): 0.16034408390522004, training time: 386.5709865093231, testing time: 190.667706489563
recall    : [0.11243024 0.16537972 0.20477289 0.23624255 0.26345843]
ndcg      : [0.06603357 0.0808181  0.09040295 0.09746312 0.10321207]
precision : [0.01629942 0.01206528 0.01000439 0.00868042 0.00775373]
hit_ratio : [0.27670665 0.38139774 0.44967227 0.5003748  0.54033017]
Epoch:99/500, one epoch(train+test/hour): 0.15592601729763877, training time: 383.9944951534271, testing time: 177.33915901184082
recall    : [0.11183166 0.16525994 0.20454722 0.23637011 0.26322935]
ndcg      : [0.06570483 0.08060231 0.09015422 0.0972836  0.10296238]
precision : [0.01624582 0.01205155 0.00998405 0.00867617 0.0077431 ]
hit_ratio : [0.27588732 0.38075274 0.44887037 0.49995642 0.53958929]
Epoch:108/500, one epoch(train+test/hour): 0.15923250211609735, training time: 411.6144688129425, testing time: 161.6225311756134
recall    : [0.11284913 0.16638685 0.20508491 0.23750326 0.26453596]
ndcg      : [0.06640132 0.08135107 0.09075796 0.09802433 0.10374956]
precision : [0.01639094 0.01213588 0.0100118  0.00872324 0.0077886 ]
hit_ratio : [0.27745624 0.38229552 0.45057876 0.50165609 0.54153302]
Epoch:117/500, one epoch(train+test/hour): 0.15695298790931703, training time: 394.5734312534332, testing time: 170.4573118686676
recall    : [0.11320118 0.16667857 0.20590696 0.23757122 0.26463913]
ndcg      : [0.06652437 0.08145397 0.09098191 0.09808376 0.10381995]
precision : [0.01643147 0.01215919 0.01005    0.00872226 0.00779008]
hit_ratio : [0.27840632 0.38314099 0.45132836 0.5017171  0.54148072]
Epoch:126/500, one epoch(train+test/hour): 0.14986408425701989, training time: 391.7533152103424, testing time: 147.7573812007904
recall    : [0.11338963 0.16665814 0.20600895 0.23785721 0.26503481]
ndcg      : [0.06660615 0.08149172 0.09106706 0.09818556 0.10393965]
precision : [0.01643496 0.01215222 0.01006366 0.00872891 0.00779539]
hit_ratio : [0.27842375 0.38269646 0.45167701 0.50161251 0.5415243 ]
Epoch:135/500, one epoch(train+test/hour): 0.15079257475005256, training time: 393.8856427669525, testing time: 148.96762132644653
recall    : [0.11321631 0.1674652  0.20628502 0.23810074 0.26491278]
ndcg      : [0.06674202 0.08187942 0.09131578 0.09844463 0.10412436]
precision : [0.01642755 0.01220692 0.01006714 0.00873751 0.00779173]
hit_ratio : [0.2779705  0.38424796 0.45174674 0.5021442  0.54164633]
Epoch:144/500, one epoch(train+test/hour): 0.1580921024746365, training time: 390.8945417404175, testing time: 178.23702335357666
recall    : [0.1141154  0.16801045 0.20755793 0.23900682 0.26624842]
ndcg      : [0.06707367 0.08212727 0.09174002 0.09879596 0.10455336]
precision : [0.0165474  0.01225202 0.01013106 0.00877924 0.00783287]
hit_ratio : [0.2795743  0.38492783 0.45369918 0.50268461 0.54249181]
Epoch:153/500, one epoch(train+test/hour): 0.14922824137740665, training time: 388.77155017852783, testing time: 148.45011234283447
recall    : [0.11431428 0.16844219 0.20818498 0.24023712 0.26718892]
ndcg      : [0.06732402 0.08243879 0.09209189 0.09927787 0.1049842 ]
precision : [0.01659054 0.01228296 0.01015547 0.00881531 0.00785902]
hit_ratio : [0.28002754 0.38604351 0.45480615 0.50484625 0.54457499]
Epoch:162/500, one epoch(train+test/hour): 0.16011145247353448, training time: 389.2670283317566, testing time: 187.13419556617737
recall    : [0.114648   0.16936347 0.20913023 0.24090206 0.26749255]
ndcg      : [0.06751205 0.08277056 0.0924347  0.09956028 0.10520482]
precision : [0.01662454 0.01233221 0.01019368 0.00883612 0.00786922]
hit_ratio : [0.28106478 0.38746426 0.45566906 0.50557841 0.54473189]
Epoch:171/500, one epoch(train+test/hour): 0.1494312631421619, training time: 393.23741841316223, testing time: 144.71511960029602
recall    : [0.11452201 0.16896206 0.20867276 0.24114044 0.26778418]
ndcg      : [0.06745479 0.08268804 0.09233653 0.09960636 0.10526069]
precision : [0.01656875 0.01232001 0.01018162 0.00884679 0.00787724]
hit_ratio : [0.28041978 0.38671466 0.45516352 0.50597064 0.54495851]
Epoch:180/500, one epoch(train+test/hour): 0.14944155202971565, training time: 392.57087421417236, testing time: 145.41870617866516
recall    : [0.11504812 0.16905877 0.20913688 0.24129385 0.26770735]
ndcg      : [0.06756909 0.08268599 0.09240318 0.09960758 0.10522225]
precision : [0.01665069 0.0123272  0.01019658 0.00884658 0.00787515]
hit_ratio : [0.28170107 0.38703717 0.45592183 0.50622342 0.54482777]
Epoch:189/500, one epoch(train+test/hour): 0.1543373034397761, training time: 393.03121423721313, testing time: 162.58307242393494
recall    : [0.11494947 0.16895745 0.20921426 0.24149619 0.26780561]
ndcg      : [0.06749435 0.08259913 0.09237433 0.09960783 0.10519198]
precision : [0.01664502 0.01231369 0.01019832 0.00885409 0.0078755 ]
hit_ratio : [0.28100377 0.38621784 0.45548602 0.50601422 0.54458371]
Epoch:198/500, one epoch(train+test/hour): 0.16169362439049614, training time: 394.7357647418976, testing time: 187.36127734184265
recall    : [0.1147232  0.16880334 0.20867458 0.24023936 0.2667843 ]
ndcg      : [0.06728253 0.08242234 0.09208359 0.0991798  0.10481759]
precision : [0.01660754 0.01230454 0.01016956 0.00881563 0.00785196]
hit_ratio : [0.28061153 0.38665365 0.45369047 0.50355624 0.54283174]
Epoch:207/500, one epoch(train+test/hour): 0.1581690060430103, training time: 397.0313367843628, testing time: 172.37707924842834
recall    : [0.11492078 0.16912139 0.20889511 0.24086432 0.26740819]
ndcg      : [0.06749698 0.08266949 0.09230977 0.09947776 0.10510885]
precision : [0.01663587 0.01233112 0.01018249 0.00883219 0.00786303]
hit_ratio : [0.28130012 0.38661007 0.4540827  0.50452374 0.54367722]
Epoch:216/500, one epoch(train+test/hour): 0.1723385810189777, training time: 391.02853751182556, testing time: 229.39034795761108
recall    : [0.11498947 0.16907967 0.20869785 0.24099569 0.26827997]
ndcg      : [0.06759467 0.08273145 0.09235681 0.09959049 0.10536754]
precision : [0.01665025 0.01232241 0.01018075 0.00883775 0.00788561]
hit_ratio : [0.28122167 0.3866275  0.45402169 0.50485496 0.5448452 ]
Epoch:225/500, one epoch(train+test/hour): 0.15433589650524987, training time: 386.42944717407227, testing time: 169.1797697544098
recall    : [0.1144279  0.16882007 0.20889287 0.24078911 0.26734475]
ndcg      : [0.06728361 0.0824834  0.0922039  0.09936185 0.10498211]
precision : [0.01658488 0.012298   0.01017726 0.00882707 0.0078544 ]
hit_ratio : [0.28014957 0.38570358 0.45387351 0.50420124 0.54328499]
Epoch:234/500, one epoch(train+test/hour): 0.16006718973318737, training time: 389.7105813026428, testing time: 186.53129243850708
recall    : [0.11423804 0.16882958 0.20811778 0.24004968 0.26649893]
ndcg      : [0.06732404 0.08255887 0.09209449 0.09923529 0.10484636]
precision : [0.01655263 0.01229582 0.01014341 0.00879166 0.00782773]
hit_ratio : [0.2797922  0.38533749 0.4530629  0.50292867 0.54182065]
Epoch:243/500, one epoch(train+test/hour): 0.2582512535651525, training time: 729.780012845993, testing time: 199.92449569702148
recall    : [0.11414801 0.16823454 0.20831868 0.23976002 0.26623047]
ndcg      : [0.06725296 0.08239361 0.0921071  0.09915618 0.10476252]
precision : [0.0164951  0.01225529 0.01014327 0.00878284 0.00781727]
hit_ratio : [0.27944355 0.3849104  0.45267938 0.50239697 0.54134126]
Epoch:252/500, one epoch(train+test/hour): 0.2519339778025945, training time: 727.4392099380493, testing time: 179.52310037612915
recall    : [0.11433793 0.16855858 0.20848332 0.23997332 0.26634791]
ndcg      : [0.06730079 0.08246724 0.09212673 0.0991991  0.10481095]
precision : [0.01652997 0.01228296 0.0101437  0.00879036 0.00783043]
hit_ratio : [0.27944355 0.38542466 0.4533854  0.50288508 0.54126281]
Epoch:261/500, one epoch(train+test/hour): 0.2615333417389128, training time: 726.1169412136078, testing time: 215.40308451652527
recall    : [0.11341448 0.16765378 0.2066255  0.23862393 0.26492667]
ndcg      : [0.06660088 0.08177004 0.09124032 0.09839792 0.10396117]
precision : [0.01636479 0.01219798 0.01006758 0.00873828 0.00777474]
hit_ratio : [0.27756084 0.38319329 0.45051775 0.50061014 0.5390576 ]
Epoch:270/500, one epoch(train+test/hour): 0.2849931397040685, training time: 793.1161825656891, testing time: 232.8591113090515
recall    : [0.11325614 0.16774594 0.20737584 0.23893539 0.26521062]
ndcg      : [0.06660311 0.08183259 0.09146451 0.09853997 0.10410565]
precision : [0.01634649 0.0121982  0.01009692 0.00875266 0.00778842]
hit_ratio : [0.27722962 0.38304512 0.45180775 0.50063629 0.53948469]
early stopping at 270, recall@20:0.1150
training {500} epoches takes {122636.618} seconds,{34.066} hour