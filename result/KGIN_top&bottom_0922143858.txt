#################### parameter settings ####################
dataset:alibaba-fashion
data_path:data/
load_rules:True
which_rules:3
epoch:500
batch_size:1024
test_batch_size:1024
dim:64
l2:1e-05
lr:0.0001
sim_regularity:0.0001
inverse_r:False
node_dropout:True
node_dropout_rate:0.5
mess_dropout:True
mess_dropout_rate:0.1
batch_test_flag:True
channel:64
cuda:True
gpu_id:0
edge_threshold:64
adj_epoch:1
in_channel:[64, 32]
out_channel:[32, 64]
pretrain_s:False
pretrain_r:False
freeze_s:False
k_step:2
num_sample:32
gamma:0.99
Ks:[20, 40, 60, 80, 100]
test_flag:part
n_factors:4
ind:distance
context_hops:3
save:True
out_dir:./weights/
rank:[20, 40, 60, 80, 100]
flag_step:30
#################### experimental settings ####################
0) Model: KGIN
1) recommender: GCN
2) sampler: random sampling
#################### start training ####################
Epoch:0/500, one epoch(train+test/hour): 0.2989935599433051, training time: 837.8081405162811, testing time: 238.5686731338501
recall    : [0.03381849 0.05409427 0.06971693 0.08369066 0.09615001]
ndcg      : [0.01922736 0.02487423 0.02866586 0.0317877  0.03442294]
precision : [0.00505064 0.00401667 0.00345222 0.0031067  0.00285676]
hit_ratio : [0.09543442 0.14712189 0.18513353 0.21803745 0.24526707]
Epoch:2/500, one epoch(train+test/hour): 0.3024044014347924, training time: 847.8372685909271, testing time: 240.81857347488403
recall    : [0.04525656 0.07192461 0.09378283 0.11219792 0.12840467]
ndcg      : [0.0256458  0.03308064 0.03837438 0.04248096 0.04590269]
precision : [0.00665705 0.00529034 0.00459856 0.00412781 0.0037833 ]
hit_ratio : [0.12403249 0.18904714 0.23918311 0.27916463 0.31274841]
Epoch:4/500, one epoch(train+test/hour): 0.3150100076198578, training time: 867.2841415405273, testing time: 266.75188183784485
recall    : [0.05356299 0.0836502  0.10704889 0.12698935 0.14415099]
ndcg      : [0.03070783 0.03909601 0.04475123 0.04921243 0.05285346]
precision : [0.00784551 0.00612754 0.00522845 0.00466299 0.00424657]
hit_ratio : [0.14451572 0.21571892 0.26777247 0.30898299 0.34276724]
Epoch:6/500, one epoch(train+test/hour): 0.27719448884328207, training time: 834.2711868286133, testing time: 163.6289713382721
recall    : [0.0619012  0.09456368 0.1195595  0.14061496 0.15881742]
ndcg      : [0.03586261 0.04500442 0.05107792 0.05578128 0.05965559]
precision : [0.00905969 0.00694861 0.005872   0.00518182 0.00469772]
hit_ratio : [0.16519071 0.24155394 0.29510669 0.33678788 0.37165295]
Epoch:8/500, one epoch(train+test/hour): 0.2989554625087314, training time: 832.5010507106781, testing time: 243.73861169815063
recall    : [0.06979038 0.1057126  0.13259798 0.15524058 0.17474822]
ndcg      : [0.04103156 0.05107456 0.05760055 0.06265737 0.06678678]
precision : [0.01022505 0.0077736  0.00651236 0.00572125 0.00515994]
hit_ratio : [0.18429677 0.26544523 0.32081096 0.36435744 0.40008542]
Epoch:10/500, one epoch(train+test/hour): 0.3003119786580404, training time: 844.5748808383942, testing time: 236.54824042320251
recall    : [0.07704769 0.11577622 0.14538388 0.16976282 0.1908122 ]
ndcg      : [0.04518164 0.0560058  0.06321577 0.06868107 0.07314687]
precision : [0.01128103 0.00850664 0.00714719 0.00627648 0.0056532 ]
hit_ratio : [0.20083153 0.28694826 0.34560874 0.39115996 0.42837843]
Epoch:12/500, one epoch(train+test/hour): 0.30076372881730395, training time: 843.2403876781464, testing time: 239.50903367996216
recall    : [0.08523141 0.12749532 0.15952389 0.18581026 0.20767262]
ndcg      : [0.04996436 0.06180799 0.06960072 0.0755056  0.08014342]
precision : [0.01248954 0.00938786 0.00785408 0.00687823 0.00616109]
hit_ratio : [0.22066976 0.3116676  0.3735531  0.42010669 0.45690677]
Epoch:14/500, one epoch(train+test/hour): 0.30366292085912494, training time: 845.9528744220734, testing time: 247.23363852500916
recall    : [0.09022647 0.13621896 0.17003386 0.19705249 0.22027818]
ndcg      : [0.05272581 0.06559252 0.0738157  0.07990367 0.08481665]
precision : [0.01320602 0.01001063 0.00835745 0.00729464 0.00652875]
hit_ratio : [0.23175685 0.32916986 0.39343491 0.44027613 0.47772122]
Epoch:16/500, one epoch(train+test/hour): 0.3011113225089179, training time: 843.9936878681183, testing time: 240.00707125663757
recall    : [0.09375103 0.14078387 0.17638096 0.20469547 0.22923189]
ndcg      : [0.05425613 0.06745826 0.0760973  0.08245933 0.08763724]
precision : [0.01365839 0.01033837 0.00865569 0.00755918 0.00677489]
hit_ratio : [0.23902622 0.33750261 0.4037724  0.45249634 0.49198103]
Epoch:18/500, one epoch(train+test/hour): 0.3029548588726256, training time: 842.9914791584015, testing time: 247.64600825309753
recall    : [0.09658381 0.14523809 0.18120545 0.21091364 0.23581644]
ndcg      : [0.05601792 0.06961662 0.07838103 0.08502724 0.09030233]
precision : [0.01408244 0.01063973 0.0088951  0.00777731 0.00696822]
hit_ratio : [0.24522349 0.34608814 0.41295063 0.4628687  0.50221393]
Epoch:20/500, one epoch(train+test/hour): 0.3014375310473972, training time: 840.6005051136017, testing time: 244.574604511261
recall    : [0.09844022 0.14769785 0.1839732  0.21357412 0.23923766]
ndcg      : [0.05695797 0.07073283 0.0795759  0.08620196 0.09163193]
precision : [0.01430993 0.01079575 0.00901248 0.00786295 0.00705774]
hit_ratio : [0.24901506 0.35109999 0.4179189  0.46787184 0.50787079]
Epoch:22/500, one epoch(train+test/hour): 0.3004642233583662, training time: 840.6743042469025, testing time: 240.9968981742859
recall    : [0.09969185 0.14945928 0.18638349 0.216497   0.24203111]
ndcg      : [0.05784095 0.07173695 0.08072191 0.08746175 0.0928769 ]
precision : [0.01449603 0.01091996 0.00911736 0.00795828 0.00713444]
hit_ratio : [0.25145562 0.35407224 0.42186737 0.47220382 0.51229865]
Epoch:24/500, one epoch(train+test/hour): 0.29876885857847, training time: 838.0111701488495, testing time: 237.5567181110382
recall    : [0.10082449 0.1511073  0.18868041 0.21872593 0.24449253]
ndcg      : [0.05831178 0.07237959 0.08150876 0.08824256 0.09367773]
precision : [0.01465466 0.01105027 0.00922951 0.00804446 0.00719746]
hit_ratio : [0.25413151 0.35727111 0.42544104 0.47590824 0.51583746]
Epoch:26/500, one epoch(train+test/hour): 0.2992443353599972, training time: 837.2635846138, testing time: 240.0160207748413
recall    : [0.10227899 0.15321972 0.19079265 0.22130189 0.24673615]
ndcg      : [0.05934535 0.0735938  0.08273094 0.08955451 0.09493698]
precision : [0.01483073 0.01119212 0.00932771 0.00813064 0.00726545]
hit_ratio : [0.25702531 0.36136776 0.42937208 0.47966495 0.51904505]
Epoch:28/500, one epoch(train+test/hour): 0.2979129950205485, training time: 837.4864888191223, testing time: 235.00029158592224
recall    : [0.10367562 0.15440997 0.19230477 0.22236569 0.2484018 ]
ndcg      : [0.06036486 0.07455938 0.08376158 0.09049376 0.0959907 ]
precision : [0.01502815 0.01127667 0.00939628 0.00816932 0.00730763]
hit_ratio : [0.25971864 0.36328534 0.43194338 0.48099854 0.52159891]
Epoch:30/500, one epoch(train+test/hour): 0.29943086988396117, training time: 837.780298948288, testing time: 240.17083096504211
recall    : [0.10466537 0.15654615 0.19406842 0.22432251 0.25055327]
ndcg      : [0.06116371 0.07564576 0.08476519 0.09153139 0.09707772]
precision : [0.01520902 0.01142725 0.00948025 0.00823622 0.00736899]
hit_ratio : [0.26235967 0.36714664 0.43496792 0.48417126 0.52422251]
Epoch:32/500, one epoch(train+test/hour): 0.3010082871384091, training time: 838.7558932304382, testing time: 244.87393856048584
recall    : [0.1056961  0.15735643 0.19528443 0.2259771  0.25211203]
ndcg      : [0.06178345 0.0762083  0.08541531 0.09228429 0.09783336]
precision : [0.0153585  0.01148717 0.00953385 0.00829527 0.00742321]
hit_ratio : [0.26405062 0.36850638 0.43659787 0.48694303 0.52686354]
Epoch:34/500, one epoch(train+test/hour): 0.2994586369726393, training time: 839.5736300945282, testing time: 238.47746014595032
recall    : [0.10629412 0.15801346 0.19691181 0.22808171 0.25430097]
ndcg      : [0.06223687 0.07670094 0.0861395  0.09312746 0.09868421]
precision : [0.01544043 0.01153271 0.00960751 0.00837274 0.00748414]
hit_ratio : [0.26558469 0.36981382 0.43941322 0.49011575 0.52985322]
Epoch:36/500, one epoch(train+test/hour): 0.3012131014797423, training time: 842.9305310249329, testing time: 241.43663001060486
recall    : [0.10741164 0.15898092 0.19801592 0.22832464 0.25457229]
ndcg      : [0.06275681 0.07716918 0.08663583 0.0934293  0.09899719]
precision : [0.01557859 0.01160005 0.00966358 0.00838287 0.00749442]
hit_ratio : [0.26798166 0.37221079 0.44140053 0.4905167  0.53010599]
Epoch:38/500, one epoch(train+test/hour): 0.301795430249638, training time: 844.0452084541321, testing time: 242.4183316230774
recall    : [0.1080319  0.16087441 0.19937009 0.23033025 0.25638851]
ndcg      : [0.06303669 0.07778617 0.08713818 0.09406168 0.09957188]
precision : [0.01568057 0.01173537 0.00973476 0.00845206 0.00753835]
hit_ratio : [0.26894917 0.37514818 0.44341399 0.49363712 0.53238094]
Epoch:40/500, one epoch(train+test/hour): 0.3102111260758506, training time: 864.104437828064, testing time: 252.6556112766266
recall    : [0.10845121 0.16060558 0.1991811  0.23034923 0.25694635]
ndcg      : [0.06329634 0.07787544 0.08726461 0.09422449 0.09985248]
precision : [0.01574332 0.01172294 0.00973709 0.00845565 0.00755953]
hit_ratio : [0.27019559 0.37438114 0.4430479  0.49379402 0.53374067]
Epoch:42/500, one epoch(train+test/hour): 0.2834656633933385, training time: 859.6398751735687, testing time: 160.83651161193848
recall    : [0.11044692 0.16292738 0.20147852 0.23280543 0.25963579]
ndcg      : [0.06457594 0.07924763 0.08861785 0.09562066 0.10128794]
precision : [0.01601091 0.01188812 0.00984241 0.00854423 0.00763406]
hit_ratio : [0.27398717 0.37862597 0.4470661  0.49716721 0.53706157]
Epoch:44/500, one epoch(train+test/hour): 0.273370595574379, training time: 824.3308885097504, testing time: 159.8032534122467
recall    : [0.10976776 0.16248317 0.20092514 0.23250352 0.25964224]
ndcg      : [0.06425375 0.07899955 0.08834047 0.09539107 0.10111785]
precision : [0.01594075 0.01187199 0.00982251 0.0085353  0.00763519]
hit_ratio : [0.2725577  0.3779461  0.44589812 0.49655707 0.53714873]
Epoch:46/500, one epoch(train+test/hour): 0.31419148551093207, training time: 871.2695858478546, testing time: 259.81975960731506
recall    : [0.11082015 0.16387577 0.20289224 0.23452872 0.26100388]
ndcg      : [0.06502878 0.07986948 0.08931829 0.09639345 0.10199812]
precision : [0.01608674 0.01197768 0.00990473 0.00860339 0.00767459]
hit_ratio : [0.27486751 0.38037794 0.44906213 0.49944216 0.53893557]
Epoch:48/500, one epoch(train+test/hour): 0.3172850783665975, training time: 879.0344634056091, testing time: 263.19181656837463
recall    : [0.11037588 0.16326996 0.20229903 0.23404017 0.26065426]
ndcg      : [0.06464755 0.07945645 0.08893701 0.09603975 0.10166063]
precision : [0.01599174 0.01191645 0.00988047 0.00859097 0.00766578]
hit_ratio : [0.2733596  0.37903563 0.44812949 0.49871871 0.53847361]
Epoch:50/500, one epoch(train+test/hour): 0.3080262919267019, training time: 848.8376462459564, testing time: 260.0570023059845
recall    : [0.11088267 0.16491171 0.20377412 0.23548572 0.26179571]
ndcg      : [0.06520907 0.08028988 0.08974531 0.09682238 0.10239479]
precision : [0.01610461 0.01202627 0.00995253 0.00863695 0.00769734]
hit_ratio : [0.27501569 0.38188585 0.45022139 0.50121156 0.5405045 ]
Epoch:52/500, one epoch(train+test/hour): 0.31410721480846404, training time: 871.5242185592651, testing time: 259.2617530822754
recall    : [0.11152707 0.16526042 0.20453025 0.23608675 0.26246301]
ndcg      : [0.06553187 0.08055381 0.09008404 0.09712914 0.10270664]
precision : [0.01618655 0.01206615 0.00998608 0.00865743 0.00771355]
hit_ratio : [0.27607036 0.38282721 0.45162471 0.50159508 0.54062653]
Epoch:54/500, one epoch(train+test/hour): 0.3102879183822208, training time: 854.2920162677765, testing time: 262.7444875240326
recall    : [0.11186201 0.16589593 0.20467401 0.23630621 0.26333921]
ndcg      : [0.06583435 0.08092153 0.09033302 0.09741572 0.10313175]
precision : [0.01622751 0.01209818 0.0099871  0.00866898 0.00774074]
hit_ratio : [0.27675023 0.38333275 0.45136322 0.50232724 0.54223032]
Epoch:56/500, one epoch(train+test/hour): 0.31136896557278104, training time: 853.7188656330109, testing time: 267.2094078063965
recall    : [0.11271292 0.16556333 0.2055     0.23709235 0.26406547]
ndcg      : [0.06633675 0.08116323 0.09081953 0.09789401 0.10360085]
precision : [0.01630857 0.01209687 0.01001848 0.00869415 0.00776044]
hit_ratio : [0.2779705  0.38305383 0.45274039 0.50340806 0.54318911]
Epoch:58/500, one epoch(train+test/hour): 0.31505439844396377, training time: 874.6693677902222, testing time: 259.5264632701874
recall    : [0.11291829 0.1664579  0.20527831 0.23745864 0.2644994 ]
ndcg      : [0.06639421 0.08134759 0.09078623 0.0979788  0.10369138]
precision : [0.01637089 0.01214002 0.01002022 0.0087081  0.00777073]
hit_ratio : [0.27862422 0.38449202 0.45264452 0.50400077 0.54386026]
Epoch:60/500, one epoch(train+test/hour): 0.3106668175591363, training time: 852.9787893295288, testing time: 265.4217507839203
recall    : [0.11277146 0.16695914 0.20578092 0.23759575 0.26466159]
ndcg      : [0.0663259  0.08147107 0.09088828 0.09800591 0.10372291]
precision : [0.01635564 0.01217946 0.01003562 0.00871147 0.00777439]
hit_ratio : [0.27835402 0.38571229 0.45342898 0.50403563 0.54400844]
Epoch:62/500, one epoch(train+test/hour): 0.3324227681424883, training time: 857.5400280952454, testing time: 339.1819348335266
recall    : [0.11358039 0.16723889 0.20628972 0.23788022 0.26488846]
ndcg      : [0.06681428 0.08179593 0.09128427 0.09834942 0.10406651]
precision : [0.01648246 0.01219689 0.01006787 0.00872684 0.00778947]
hit_ratio : [0.2797922  0.38636601 0.45398682 0.50462834 0.54426993]
Epoch:64/500, one epoch(train+test/hour): 0.33477554420630135, training time: 855.7507305145264, testing time: 349.4412257671356
recall    : [0.11402472 0.16775589 0.2072695  0.23955609 0.26668304]
ndcg      : [0.06692453 0.08190987 0.09151479 0.09873286 0.10447411]
precision : [0.01654914 0.01222282 0.01010971 0.00878273 0.00783732]
hit_ratio : [0.28119552 0.38667108 0.45548602 0.50707761 0.54646642]
Epoch:66/500, one epoch(train+test/hour): 0.3149402783976661, training time: 861.4864466190338, testing time: 272.2985534667969
recall    : [0.11405653 0.16843092 0.20847796 0.24048459 0.267437  ]
ndcg      : [0.06698204 0.08216431 0.09188844 0.09905346 0.1047637 ]
precision : [0.01654173 0.01226706 0.01016317 0.00881454 0.00786042]
hit_ratio : [0.28082072 0.38758629 0.45746461 0.50802768 0.54746008]
Epoch:68/500, one epoch(train+test/hour): 0.3163358781735102, training time: 864.8599758148193, testing time: 273.9491822719574
recall    : [0.1145039  0.16894392 0.2086587  0.24060334 0.26784751]
ndcg      : [0.0670293  0.08223631 0.09187778 0.09903969 0.10479202]
precision : [0.01658357 0.01230715 0.01017305 0.00882555 0.00787018]
hit_ratio : [0.28146573 0.38871941 0.4578307  0.50807126 0.54847117]
Epoch:70/500, one epoch(train+test/hour): 0.3192550733354357, training time: 878.0080442428589, testing time: 271.3102173805237
recall    : [0.11471051 0.16887848 0.20835785 0.24050688 0.2678345 ]
ndcg      : [0.06721517 0.08238485 0.09196866 0.09915905 0.10493633]
precision : [0.01659839 0.01231848 0.01016448 0.00881727 0.0078687 ]
hit_ratio : [0.28141343 0.38831846 0.45652326 0.50819329 0.54747751]
Epoch:72/500, one epoch(train+test/hour): 0.3144581851032045, training time: 861.5842282772064, testing time: 270.4652330875397
recall    : [0.11458803 0.1690121  0.20867664 0.24118047 0.26809344]
ndcg      : [0.06722328 0.08241744 0.09206138 0.09932856 0.10502376]
precision : [0.01660754 0.01231522 0.010179   0.00884037 0.00787576]
hit_ratio : [0.28196255 0.3888763  0.45779583 0.50926539 0.54815738]
Epoch:74/500, one epoch(train+test/hour): 0.3149279173877504, training time: 862.8790402412415, testing time: 270.8614573478699
recall    : [0.11487774 0.16959556 0.20940423 0.24178569 0.26866647]
ndcg      : [0.06749349 0.0828084  0.09246811 0.09970814 0.10539353]
precision : [0.01663108 0.01237035 0.01021561 0.00886303 0.00789328]
hit_ratio : [0.28232864 0.39029705 0.45872847 0.51025033 0.54909002]
Epoch:76/500, one epoch(train+test/hour): 0.3127874368429184, training time: 856.3313224315643, testing time: 269.70344734191895
recall    : [0.11466336 0.16893917 0.2089494  0.24126139 0.26808079]
ndcg      : [0.06750128 0.08266321 0.09237396 0.09960312 0.10528267]
precision : [0.01661974 0.01231129 0.01018554 0.00883917 0.00787471]
hit_ratio : [0.28157904 0.38843177 0.45824036 0.50889059 0.54839272]
Epoch:78/500, one epoch(train+test/hour): 0.3098910664849811, training time: 859.0143468379974, testing time: 256.5934896469116
recall    : [0.11463096 0.1686636  0.2087286  0.2413858  0.26852406]
ndcg      : [0.06743396 0.0825258  0.09228198 0.09957287 0.10531472]
precision : [0.01659229 0.01228449 0.01018714 0.0088469  0.00788831]
hit_ratio : [0.28157032 0.38795237 0.45790043 0.50949202 0.54898543]
Epoch:80/500, one epoch(train+test/hour): 0.28725537366337245, training time: 850.015736579895, testing time: 184.10360741615295
recall    : [0.1151169  0.16935386 0.20889305 0.24139385 0.26887654]
ndcg      : [0.06767432 0.08282899 0.0924402  0.09969424 0.10550271]
precision : [0.01668119 0.01234899 0.01019469 0.00884614 0.00789581]
hit_ratio : [0.28218046 0.38928596 0.45817935 0.50956175 0.54922077]
Epoch:82/500, one epoch(train+test/hour): 0.2873492055469089, training time: 826.1179251670837, testing time: 208.33921337127686
recall    : [0.11592184 0.16994733 0.21012266 0.24257619 0.26965756]
ndcg      : [0.06811492 0.08323268 0.09299462 0.10023028 0.10596738]
precision : [0.01679886 0.01240172 0.01025934 0.00889059 0.00792344]
hit_ratio : [0.28420264 0.39014887 0.46031483 0.51111324 0.55051077]
Epoch:84/500, one epoch(train+test/hour): 0.31263550493452286, training time: 866.3902053833008, testing time: 259.0976095199585
recall    : [0.1158605  0.1706173  0.21012711 0.24276441 0.27031367]
ndcg      : [0.06816558 0.0834633  0.09307068 0.10036402 0.10618407]
precision : [0.01678928 0.0124392  0.01025585 0.00890051 0.00793974]
hit_ratio : [0.28397601 0.39121226 0.46016666 0.51149676 0.551487  ]
Epoch:86/500, one epoch(train+test/hour): 0.3041616843806373, training time: 840.8308691978455, testing time: 254.15119242668152
recall    : [0.11558031 0.16992355 0.21018345 0.2425868  0.270123  ]
ndcg      : [0.06803809 0.08324269 0.0930048  0.10024984 0.10606334]
precision : [0.01674744 0.01240281 0.01025353 0.00889506 0.00793477]
hit_ratio : [0.28357506 0.39015759 0.46014922 0.51127013 0.55061537]
Epoch:88/500, one epoch(train+test/hour): 0.3050623546706306, training time: 842.1840147972107, testing time: 256.0404601097107
recall    : [0.11607717 0.17013374 0.21024202 0.24299217 0.27049952]
ndcg      : [0.06812547 0.08324564 0.09299905 0.10030963 0.10613306]
precision : [0.01679581 0.01240608 0.0102621  0.00890726 0.00794741]
hit_ratio : [0.28395858 0.3899484  0.46001848 0.51140088 0.55162646]
Epoch:90/500, one epoch(train+test/hour): 0.3067335704962412, training time: 856.7158925533295, testing time: 247.52495956420898
recall    : [0.11615755 0.17065289 0.21034578 0.24306327 0.27039481]
ndcg      : [0.06808104 0.08334216 0.09298522 0.10030136 0.10607882]
precision : [0.01680104 0.01245424 0.01026878 0.00891674 0.00794767]
hit_ratio : [0.28402831 0.39133429 0.46048044 0.51188027 0.551487  ]
Epoch:92/500, one epoch(train+test/hour): 0.30159874942567616, training time: 836.7016839981079, testing time: 249.05381202697754
recall    : [0.11594151 0.17061321 0.21091116 0.24302637 0.27009777]
ndcg      : [0.06799805 0.08330143 0.09306932 0.1002717  0.10600208]
precision : [0.01676443 0.01244204 0.01027997 0.00891086 0.00793791]
hit_ratio : [0.28360993 0.39098564 0.46132592 0.51189771 0.55082456]
Epoch:94/500, one epoch(train+test/hour): 0.3006042963928647, training time: 834.4891839027405, testing time: 247.68628120422363
recall    : [0.116472   0.17123379 0.21102614 0.24371574 0.27090837]
ndcg      : [0.06840531 0.08372708 0.09337824 0.10069046 0.10643164]
precision : [0.01684767 0.01249281 0.01029246 0.00893417 0.00795481]
hit_ratio : [0.28527474 0.39217976 0.46102085 0.51283035 0.55146956]
Epoch:96/500, one epoch(train+test/hour): 0.3064414992597368, training time: 850.9175789356232, testing time: 252.2718152999878
recall    : [0.1161167  0.17063351 0.2101377  0.24280912 0.27024284]
ndcg      : [0.06820991 0.08344588 0.09305377 0.10035704 0.10616917]
precision : [0.01680845 0.01243855 0.01025425 0.00890225 0.00794279]
hit_ratio : [0.28460358 0.39073286 0.45971341 0.51129628 0.55103375]
Epoch:98/500, one epoch(train+test/hour): 0.3040964483552509, training time: 839.4509584903717, testing time: 255.29625177383423
recall    : [0.11628576 0.17136667 0.21086113 0.24329126 0.27088168]
ndcg      : [0.06843639 0.08380508 0.0934259  0.1006803  0.10651401]
precision : [0.01683939 0.01248584 0.01029188 0.00892459 0.00796126]
hit_ratio : [0.28486507 0.3916655  0.46085524 0.51182798 0.55167004]
Epoch:100/500, one epoch(train+test/hour): 0.3024191627237532, training time: 837.9395196437836, testing time: 250.76946425437927
recall    : [0.11625231 0.17098038 0.21109904 0.24303429 0.27029055]
ndcg      : [0.06842962 0.08373075 0.09348675 0.10064938 0.10642452]
precision : [0.01682283 0.01245794 0.0102958  0.00891587 0.0079495 ]
hit_ratio : [0.28420264 0.39136915 0.46093369 0.51154034 0.5506851 ]
Epoch:102/500, one epoch(train+test/hour): 0.3040676471922133, training time: 836.858072757721, testing time: 257.7854554653168
recall    : [0.11635872 0.17113861 0.21115484 0.24292366 0.27001001]
ndcg      : [0.0683401  0.08365722 0.09337364 0.10051546 0.10623601]
precision : [0.01683547 0.01247712 0.0102974  0.00891783 0.00794069]
hit_ratio : [0.28429851 0.39130814 0.46090754 0.51100865 0.54995293]
Epoch:104/500, one epoch(train+test/hour): 0.30411580350663925, training time: 837.5160727500916, testing time: 257.300817489624
recall    : [0.11697301 0.17149439 0.21128275 0.24343535 0.27078715]
ndcg      : [0.0686598  0.08390682 0.0935631  0.10077258 0.10656845]
precision : [0.01692133 0.01250545 0.0103051  0.00893069 0.00796379]
hit_ratio : [0.28585001 0.39190084 0.4609947  0.51185412 0.55126037]
Epoch:106/500, one epoch(train+test/hour): 0.31101649324099223, training time: 858.0962369441986, testing time: 261.563134431839
recall    : [0.11674714 0.17120979 0.2111648  0.24336988 0.27042757]
ndcg      : [0.06860714 0.08385391 0.0935527  0.10077612 0.10650966]
precision : [0.01688472 0.0124878  0.01029987 0.00892938 0.00795429]
hit_ratio : [0.28542291 0.39136915 0.46039328 0.51133115 0.55028415]
Epoch:108/500, one epoch(train+test/hour): 0.3031118976407581, training time: 838.8149387836456, testing time: 252.38789081573486
recall    : [0.11632431 0.17094061 0.21080881 0.24268364 0.2702737 ]
ndcg      : [0.06824127 0.08351741 0.09319857 0.10034639 0.10618568]
precision : [0.01684419 0.01246862 0.01028621 0.00890661 0.00795002]
hit_ratio : [0.28479534 0.39122097 0.45994003 0.51036364 0.55051949]
Epoch:110/500, one epoch(train+test/hour): 0.3043836212820477, training time: 838.4390544891357, testing time: 257.34198021888733
recall    : [0.1163273  0.17083409 0.21076285 0.24303127 0.27026786]
ndcg      : [0.06839228 0.08361649 0.09333853 0.1005546  0.10632934]
precision : [0.01685247 0.01244618 0.01028578 0.0089101  0.0079468 ]
hit_ratio : [0.28500453 0.3909682  0.4599749  0.51101736 0.55040618]
Epoch:112/500, one epoch(train+test/hour): 0.31080434050824907, training time: 850.7855815887451, testing time: 268.11004185676575
recall    : [0.11674456 0.17163186 0.21137118 0.24375928 0.27107504]
ndcg      : [0.06876723 0.08411271 0.09376949 0.10102542 0.10679682]
precision : [0.01690128 0.01250763 0.01030873 0.00893777 0.00796458]
hit_ratio : [0.2853096  0.39222335 0.46115159 0.51224636 0.55160031]
Epoch:114/500, one epoch(train+test/hour): 0.3091842449373669, training time: 847.9784600734711, testing time: 265.08481788635254
recall    : [0.11691141 0.17137545 0.21161876 0.24379114 0.27080898]
ndcg      : [0.06892555 0.08416126 0.09393568 0.10112382 0.10685026]
precision : [0.01692046 0.01249717 0.0103234  0.00893287 0.00795795]
hit_ratio : [0.28576285 0.39225821 0.46123876 0.51188027 0.55099017]
Epoch:116/500, one epoch(train+test/hour): 0.3136645979351468, training time: 873.5762791633606, testing time: 255.61626958847046
recall    : [0.11703751 0.17138467 0.21179843 0.24386285 0.27078319]
ndcg      : [0.06878485 0.08397108 0.09378683 0.10097562 0.10666724]
precision : [0.01694225 0.01249172 0.01032878 0.00894551 0.00795839]
hit_ratio : [0.28580643 0.39190956 0.46157869 0.51174953 0.55038003]
Epoch:118/500, one epoch(train+test/hour): 0.3233492632044686, training time: 866.9108617305756, testing time: 297.14648175239563
recall    : [0.11690805 0.17161129 0.21172702 0.24419938 0.27131565]
ndcg      : [0.06880053 0.08409712 0.09384047 0.101108   0.10684965]
precision : [0.01692438 0.01250893 0.01032515 0.00895248 0.00797399]
hit_ratio : [0.285789   0.39270274 0.46119517 0.51193257 0.55114706]
Epoch:120/500, one epoch(train+test/hour): 0.2804707252979279, training time: 821.7665958404541, testing time: 187.9280138015747
recall    : [0.11719357 0.17179442 0.21222501 0.24441503 0.27145898]
ndcg      : [0.06896849 0.0842578  0.09406154 0.10126829 0.10700181]
precision : [0.01694312 0.01252767 0.01034883 0.00896021 0.00797983]
hit_ratio : [0.28579771 0.39236281 0.46178788 0.51242068 0.5511122 ]
Epoch:122/500, one epoch(train+test/hour): 0.3070062379704581, training time: 841.0181167125702, testing time: 264.20433712005615
recall    : [0.1171822  0.17156158 0.21143732 0.24350058 0.27117599]
ndcg      : [0.06895904 0.08417728 0.09387799 0.10107548 0.10691729]
precision : [0.0169344  0.01249542 0.01031599 0.00893788 0.00797077]
hit_ratio : [0.28585873 0.39186598 0.46064605 0.5109302  0.55071996]
Epoch:124/500, one epoch(train+test/hour): 0.30643267585171596, training time: 844.9562411308289, testing time: 258.2013897895813
recall    : [0.11727284 0.17157249 0.21209453 0.24420202 0.27114038]
ndcg      : [0.06901143 0.08421611 0.09404941 0.10124247 0.10694841]
precision : [0.01695837 0.01251068 0.01034389 0.00895324 0.00797077]
hit_ratio : [0.286434   0.39249355 0.46162227 0.5123771  0.5511122 ]
Epoch:126/500, one epoch(train+test/hour): 0.3179675257868237, training time: 861.2178349494934, testing time: 283.46525502204895
recall    : [0.11675095 0.17117458 0.21164126 0.24367403 0.27094998]
ndcg      : [0.06862153 0.08387967 0.09369556 0.10087811 0.10664842]
precision : [0.0168821  0.01248475 0.01032355 0.0089393  0.00796493]
hit_ratio : [0.2849348  0.3914999  0.46111673 0.51150547 0.55056307]
Epoch:128/500, one epoch(train+test/hour): 0.3041410657432344, training time: 840.4112348556519, testing time: 254.4965991973877
recall    : [0.11704368 0.1715608  0.21188423 0.24406436 0.27098279]
ndcg      : [0.06879862 0.08406334 0.09385091 0.10106095 0.10677245]
precision : [0.0169283  0.01250567 0.01033531 0.0089527  0.00797277]
hit_ratio : [0.28561467 0.39220591 0.46150024 0.51192385 0.55085071]
Epoch:130/500, one epoch(train+test/hour): 0.30583395116859013, training time: 849.9666035175323, testing time: 251.03561902046204
recall    : [0.11690476 0.17146769 0.21189488 0.24384831 0.27124755]
ndcg      : [0.06876812 0.08403144 0.09385585 0.10102438 0.10682914]
precision : [0.0169344  0.01250174 0.0103372  0.00894877 0.00798018]
hit_ratio : [0.28561467 0.39170037 0.46165714 0.51112196 0.55109476]
Epoch:132/500, one epoch(train+test/hour): 0.3008105830351512, training time: 832.4700224399567, testing time: 250.4480743408203
recall    : [0.1172618  0.17175536 0.21217543 0.24454537 0.27148326]
ndcg      : [0.0689141  0.08414181 0.09396471 0.10122226 0.10692819]
precision : [0.01698975 0.01252048 0.01035173 0.00897024 0.00798393]
hit_ratio : [0.28639042 0.3921972  0.46160484 0.51234224 0.55121679]
Epoch:134/500, one epoch(train+test/hour): 0.3030430226193534, training time: 836.2831573486328, testing time: 254.67172241210938
recall    : [0.11717494 0.17139142 0.2119482  0.24397874 0.27074878]
ndcg      : [0.06874244 0.08390029 0.09375078 0.10092563 0.10660027]
precision : [0.01698496 0.01249455 0.01034011 0.00894856 0.00796266]
hit_ratio : [0.28637299 0.39198801 0.46158741 0.51143574 0.55004881]
Epoch:136/500, one epoch(train+test/hour): 0.3009467992517683, training time: 834.4286823272705, testing time: 248.9797933101654
recall    : [0.1170216  0.1713486  0.21122762 0.24397859 0.2705814 ]
ndcg      : [0.06873752 0.08394719 0.09363263 0.10096385 0.10659811]
precision : [0.01693527 0.01249782 0.01030641 0.00894899 0.00795604]
hit_ratio : [0.28577156 0.39190084 0.4607245  0.51126142 0.5499355 ]
Epoch:138/500, one epoch(train+test/hour): 0.3002036798000336, training time: 833.0644638538361, testing time: 247.66878080368042
recall    : [0.11700804 0.17145844 0.21166798 0.24421973 0.27091807]
ndcg      : [0.06868077 0.08391703 0.09366247 0.10097002 0.10662671]
precision : [0.01694007 0.01250153 0.01031425 0.00895771 0.00796676]
hit_ratio : [0.28556237 0.39211875 0.46088139 0.5117321  0.55004881]
Epoch:140/500, one epoch(train+test/hour): 0.30332875265015496, training time: 834.4765269756317, testing time: 257.50698041915894
recall    : [0.11740212 0.17197461 0.21199685 0.24393098 0.27102744]
ndcg      : [0.06897243 0.08424502 0.09395633 0.10111399 0.10685116]
precision : [0.01698801 0.01254794 0.01033953 0.00894692 0.00796963]
hit_ratio : [0.28646887 0.39238895 0.46141308 0.51142703 0.55002266]
Epoch:142/500, one epoch(train+test/hour): 0.31051103836960264, training time: 858.1846492290497, testing time: 259.6550862789154
recall    : [0.11708536 0.17166786 0.21166538 0.24366286 0.27123439]
ndcg      : [0.06887809 0.08414644 0.09385132 0.10103153 0.10685122]
precision : [0.01694399 0.01251525 0.01032239 0.00893831 0.00796998]
hit_ratio : [0.28565825 0.39188341 0.46121261 0.51100865 0.55086814]
Epoch:144/500, one epoch(train+test/hour): 0.30380448546674516, training time: 840.9232606887817, testing time: 252.77288508415222
recall    : [0.11672576 0.17147813 0.21098284 0.24365873 0.27065029]
ndcg      : [0.06868258 0.08400834 0.09360569 0.10092559 0.10663069]
precision : [0.01688385 0.01249826 0.01029043 0.00893668 0.00795298]
hit_ratio : [0.28454257 0.3909682  0.45979186 0.51104351 0.55004009]
Epoch:146/500, one epoch(train+test/hour): 0.3049729961156845, training time: 841.0551443099976, testing time: 256.8476366996765
recall    : [0.11662523 0.17111836 0.21137947 0.24359887 0.27066406]
ndcg      : [0.06865309 0.08392659 0.09369344 0.1009182  0.10663591]
precision : [0.01687382 0.01248387 0.01031062 0.00893777 0.00795604]
hit_ratio : [0.2846646  0.39106408 0.46038456 0.51109581 0.54981347]
Epoch:148/500, one epoch(train+test/hour): 0.310484025478363, training time: 859.1428084373474, testing time: 258.5996804237366
recall    : [0.11690921 0.17138312 0.21141682 0.24395923 0.27119077]
ndcg      : [0.0687601  0.08402151 0.0937474  0.10102509 0.10678227]
precision : [0.01689997 0.01249782 0.01031512 0.00894496 0.00796806]
hit_ratio : [0.28496967 0.39137787 0.46040199 0.51124399 0.55099888]
Epoch:150/500, one epoch(train+test/hour): 0.3055418237712648, training time: 841.7643373012543, testing time: 258.18622517585754
recall    : [0.11681132 0.17123119 0.21111109 0.24311358 0.2704219 ]
ndcg      : [0.06857389 0.08380552 0.09348659 0.10064196 0.10642202]
precision : [0.01690607 0.01248736 0.01029929 0.0089126  0.00794706]
hit_ratio : [0.2849871  0.39108151 0.45979186 0.51015445 0.54964786]
Epoch:152/500, one epoch(train+test/hour): 0.31002735177675883, training time: 849.3204007148743, testing time: 266.77806186676025
recall    : [0.1164302  0.17078791 0.21093622 0.24336231 0.27048436]
ndcg      : [0.06838228 0.08359405 0.09335019 0.10059401 0.10633453]
precision : [0.01685857 0.01245402 0.01029391 0.00892154 0.0079481 ]
hit_ratio : [0.28404574 0.39056725 0.45956523 0.51000628 0.54965658]
Epoch:154/500, one epoch(train+test/hour): 0.30857969171471067, training time: 863.6109390258789, testing time: 247.27594828605652
recall    : [0.11640839 0.17126874 0.21113667 0.24325278 0.27018188]
ndcg      : [0.06846534 0.08381578 0.09350458 0.10069573 0.1063955 ]
precision : [0.0168577  0.01248627 0.01030016 0.00892088 0.00794305]
hit_ratio : [0.28402831 0.39089847 0.45973084 0.51020675 0.54894185]
Epoch:156/500, one epoch(train+test/hour): 0.5758601678742303, training time: 1842.7626547813416, testing time: 230.33393168449402
recall    : [0.11652407 0.17131416 0.21084998 0.24295779 0.27000446]
ndcg      : [0.0684887  0.08383183 0.0934392  0.10062343 0.1063535 ]
precision : [0.01685552 0.0124891  0.01028607 0.0089101  0.00793834]
hit_ratio : [0.28433338 0.39080259 0.45909455 0.50938742 0.54865421]
Epoch:158/500, one epoch(train+test/hour): 0.5914075452751584, training time: 1837.1663129329681, testing time: 291.9008467197418
recall    : [0.11644213 0.17130521 0.21072266 0.24294168 0.27030947]
ndcg      : [0.06838174 0.08374857 0.09333166 0.10053663 0.10630694]
precision : [0.01684506 0.01249107 0.01028447 0.00891064 0.00794   ]
hit_ratio : [0.28426365 0.39109895 0.4592253  0.50942229 0.54911617]
Epoch:160/500, one epoch(train+test/hour): 0.5604481064611011, training time: 1809.1339375972748, testing time: 208.47924375534058
recall    : [0.11623728 0.17133486 0.21064966 0.24254046 0.269553  ]
ndcg      : [0.06822858 0.08364926 0.0931996  0.10034447 0.10605128]
precision : [0.0168237  0.01249259 0.01027953 0.00890018 0.00792361]
hit_ratio : [0.28408061 0.39132557 0.45935604 0.50925668 0.54798306]
early stopping at 160, recall@20:0.1174
training {500} epoches takes {162134.100} seconds,{45.037} hour