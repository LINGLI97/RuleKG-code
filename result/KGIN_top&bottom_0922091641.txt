#################### parameter settings ####################
dataset:alibaba-fashion
data_path:data/
load_rules:True
epoch:150
batch_size:1024
test_batch_size:1024
dim:64
l2:1e-05
lr:0.0001
sim_regularity:0.0001
inverse_r:True
node_dropout:True
node_dropout_rate:0.5
mess_dropout:True
mess_dropout_rate:0.1
batch_test_flag:True
channel:64
cuda:True
gpu_id:0
edge_threshold:64
adj_epoch:1
in_channel:[64, 32]
out_channel:[32, 64]
pretrain_s:False
pretrain_r:False
freeze_s:False
k_step:3
num_sample:32
gamma:0.99
Ks:[20, 40, 60, 80, 100]
test_flag:part
n_factors:4
ind:distance
context_hops:3
save:True
out_dir:./weights/
rank:[20, 40, 60, 80, 100]
flag_step:10
#################### experimental settings ####################
0) Model: KGIN
1) recommender: GCN
2) sampler: random sampling
#################### start training ####################
Epoch:0/150, one epoch(train+test/hour): 0.15976346731185914, training time: 420.9342575073242, testing time: 154.2142050266266
recall    : [0.03751843 0.05966049 0.07731596 0.09267878 0.10609666]
ndcg      : [0.0210406  0.02724836 0.03154205 0.03497849 0.03782449]
precision : [0.00554006 0.00442786 0.00382789 0.00344162 0.00315607]
hit_ratio : [0.10390663 0.16043163 0.2023656  0.23703891 0.26640402]
Epoch:3/150, one epoch(train+test/hour): 0.1642152651813295, training time: 425.45041251182556, testing time: 165.72453951835632
recall    : [0.0547276  0.08521145 0.10823791 0.12774327 0.14494017]
ndcg      : [0.03157872 0.04006815 0.04566371 0.05003264 0.05366669]
precision : [0.00795054 0.00620576 0.0052793  0.00468478 0.00425694]
hit_ratio : [0.14634614 0.2182292  0.26945471 0.31046475 0.34428387]
Epoch:6/150, one epoch(train+test/hour): 0.15733722494708166, training time: 420.42990803718567, testing time: 145.98409819602966
recall    : [0.06602055 0.09983196 0.12610392 0.14749469 0.16664433]
ndcg      : [0.03918678 0.04863259 0.05498178 0.05976457 0.06380323]
precision : [0.00960533 0.00730075 0.00614773 0.00540561 0.00489009]
hit_ratio : [0.17449969 0.25181298 0.30672547 0.34899066 0.38436127]
Epoch:9/150, one epoch(train+test/hour): 0.16631167709827424, training time: 422.4214825630188, testing time: 176.3005518913269
recall    : [0.0790852  0.11742617 0.14631945 0.1697136  0.19021547]
ndcg      : [0.04688199 0.05760241 0.06461523 0.06985831 0.07419692]
precision : [0.01153772 0.00860012 0.00716303 0.00624412 0.00560796]
hit_ratio : [0.2051548  0.28926679 0.34689004 0.39089847 0.42728889]
Epoch:12/150, one epoch(train+test/hour): 0.15825682454639012, training time: 421.8192400932312, testing time: 147.90532517433167
recall    : [0.09220094 0.13521727 0.16699126 0.19252387 0.21484497]
ndcg      : [0.0547     0.06673709 0.07446372 0.080184   0.08489959]
precision : [0.01341913 0.0098971  0.00817659 0.00708731 0.00633577]
hit_ratio : [0.23457221 0.32590126 0.38637473 0.43110662 0.46802001]
Epoch:15/150, one epoch(train+test/hour): 0.16317434390385946, training time: 418.6307911872864, testing time: 168.7968430519104
recall    : [0.09904694 0.14748096 0.18199272 0.21020355 0.23409399]
ndcg      : [0.05792739 0.07146607 0.07987022 0.08617358 0.0912457 ]
precision : [0.01436397 0.01076154 0.00889771 0.0077212  0.00689736]
hit_ratio : [0.24908479 0.34915627 0.41309881 0.46088139 0.4985531 ]
Epoch:18/150, one epoch(train+test/hour): 0.15764719393518237, training time: 418.7447807788849, testing time: 148.7851140499115
recall    : [0.10168502 0.15216751 0.18905996 0.21829851 0.24335071]
ndcg      : [0.05946211 0.07356432 0.0825214  0.0890801  0.09438306]
precision : [0.01472919 0.01109058 0.00922283 0.00801287 0.00715954]
hit_ratio : [0.2553605  0.35859598 0.42542361 0.47408654 0.51333589]
Epoch:21/150, one epoch(train+test/hour): 0.16298269821537867, training time: 415.97283363342285, testing time: 170.76487684249878
recall    : [0.10377863 0.15537348 0.19279893 0.22315974 0.24890212]
ndcg      : [0.06025263 0.07466693 0.08373894 0.09052553 0.09597666]
precision : [0.01500157 0.01130217 0.00937899 0.0081618  0.00730109]
hit_ratio : [0.25952688 0.36502859 0.4318998  0.48222753 0.52179067]
Epoch:24/150, one epoch(train+test/hour): 0.15836606310473547, training time: 419.21392846107483, testing time: 150.9038953781128
recall    : [0.10575522 0.15784087 0.19611206 0.22609424 0.25253036]
ndcg      : [0.0613539  0.07591058 0.08517063 0.09187793 0.09748612]
precision : [0.01525303 0.0114717  0.00952659 0.00825964 0.00740203]
hit_ratio : [0.26338819 0.3688899  0.43680706 0.4864985  0.52728192]
Epoch:27/150, one epoch(train+test/hour): 0.16540712694327037, training time: 416.8544638156891, testing time: 178.61118984222412
recall    : [0.1076713  0.16052651 0.19874123 0.22932722 0.25570497]
ndcg      : [0.06300319 0.0777746  0.08704202 0.09390109 0.09948865]
precision : [0.01552934 0.0116615  0.00965646 0.00839028 0.00750253]
hit_ratio : [0.26734537 0.3739279  0.44201938 0.49267833 0.53268601]
Epoch:30/150, one epoch(train+test/hour): 0.15992980890803868, training time: 419.41957116127014, testing time: 156.32773876190186
recall    : [0.10921619 0.16258198 0.20035109 0.23156763 0.25855401]
ndcg      : [0.06390736 0.07878337 0.0879649  0.09494633 0.10065527]
precision : [0.01577906 0.01180422 0.00974319 0.00846807 0.00758132]
hit_ratio : [0.27009971 0.37718778 0.44457325 0.49551112 0.5364863 ]
Epoch:33/150, one epoch(train+test/hour): 0.1619894587331348, training time: 414.2135946750641, testing time: 168.94845342636108
recall    : [0.11054757 0.16366459 0.20242601 0.23379273 0.26064456]
ndcg      : [0.0648137  0.07964098 0.08905256 0.09607126 0.10174259]
precision : [0.01597125 0.01190141 0.00985258 0.00855763 0.00764452]
hit_ratio : [0.27383899 0.37968935 0.4482951  0.49947702 0.54012098]
Epoch:36/150, one epoch(train+test/hour): 0.16020094414552052, training time: 416.81955671310425, testing time: 159.9038393497467
recall    : [0.11170616 0.16481065 0.20341064 0.23500794 0.26221058]
ndcg      : [0.06566059 0.08050106 0.08987108 0.09695133 0.10268498]
precision : [0.01613163 0.01197593 0.00989471 0.00860121 0.00768662]
hit_ratio : [0.27584373 0.38185099 0.44964612 0.50049683 0.54154173]
Epoch:39/150, one epoch(train+test/hour): 0.1627551226483451, training time: 407.4963119029999, testing time: 178.4221270084381
recall    : [0.11233449 0.16686055 0.20523375 0.2369392  0.26364403]
ndcg      : [0.06587142 0.08108112 0.0904092  0.09748977 0.10313994]
precision : [0.01624538 0.01212847 0.00999044 0.00866637 0.00773307]
hit_ratio : [0.27715117 0.3851806  0.45326337 0.50372185 0.54319782]
Epoch:42/150, one epoch(train+test/hour): 0.1564542090230518, training time: 405.0817894935608, testing time: 158.15336084365845
recall    : [0.11411486 0.16819034 0.2072754  0.23863079 0.26572113]
ndcg      : [0.06700111 0.08210805 0.09158909 0.09860652 0.1043271 ]
precision : [0.01649554 0.01224156 0.01009271 0.00873653 0.00779383]
hit_ratio : [0.28055052 0.3880744  0.45619204 0.50644132 0.54630082]
Epoch:45/150, one epoch(train+test/hour): 0.16470277415381537, training time: 410.36514616012573, testing time: 182.5648386478424
recall    : [0.11468079 0.16948164 0.20857615 0.24024059 0.26672263]
ndcg      : [0.06748702 0.08281758 0.09228453 0.0993853  0.10497123]
precision : [0.01657486 0.01233657 0.01014748 0.00879831 0.00782337]
hit_ratio : [0.28185796 0.3895736  0.45820549 0.5083589  0.54732934]
Epoch:48/150, one epoch(train+test/hour): 0.15792931344774033, training time: 409.45250487327576, testing time: 159.09302020072937
recall    : [0.11549598 0.17025117 0.20917638 0.24110019 0.26723752]
ndcg      : [0.06794165 0.08324713 0.09268367 0.09981847 0.10537238]
precision : [0.01669558 0.01239126 0.01018046 0.00882293 0.00784813]
hit_ratio : [0.2834356  0.39082874 0.4588505  0.50940485 0.54725089]
Epoch:51/150, one epoch(train+test/hour): 0.16224907921420204, training time: 408.774290561676, testing time: 175.32239151000977
recall    : [0.11585188 0.1703777  0.21016334 0.24210553 0.26881542]
ndcg      : [0.06831288 0.08357066 0.09320596 0.1003512  0.10600118]
precision : [0.01675223 0.01240172 0.01022011 0.00885399 0.00788169]
hit_ratio : [0.28388885 0.39162192 0.46014051 0.51044209 0.54935151]
Epoch:54/150, one epoch(train+test/hour): 0.15816024939219156, training time: 411.3362717628479, testing time: 158.04062294960022
recall    : [0.11629646 0.17128577 0.21032697 0.24217234 0.26934615]
ndcg      : [0.06853272 0.08388464 0.09335286 0.10049043 0.10622456]
precision : [0.01682283 0.01245685 0.01023566 0.00886946 0.00790304]
hit_ratio : [0.28468203 0.39283348 0.46100342 0.51063385 0.5498309 ]
Epoch:57/150, one epoch(train+test/hour): 0.16126824915409088, training time: 408.41854190826416, testing time: 172.14715194702148
recall    : [0.11721153 0.17144783 0.21099002 0.24294347 0.26991901]
ndcg      : [0.06905472 0.08419614 0.0937953  0.10094273 0.10665363]
precision : [0.01693397 0.01246971 0.01027299 0.0088955  0.00792335]
hit_ratio : [0.28639042 0.39298166 0.4613695  0.51182798 0.55085071]
Epoch:60/150, one epoch(train+test/hour): 0.15768986894024742, training time: 409.6222503185272, testing time: 158.0612759590149
recall    : [0.11748909 0.1721753  0.21167778 0.24397994 0.27097351]
ndcg      : [0.06908464 0.08436268 0.09395083 0.10119118 0.10690383]
precision : [0.01698408 0.0125231  0.01030437 0.00893417 0.00795455]
hit_ratio : [0.28703542 0.39422809 0.46311275 0.51351893 0.55222788]
Epoch:63/150, one epoch(train+test/hour): 0.16274841692712572, training time: 410.40522027015686, testing time: 175.4890775680542
recall    : [0.11761313 0.17297447 0.21207879 0.24454609 0.27190713]
ndcg      : [0.06928275 0.0847542  0.0942487  0.10150656 0.1072914 ]
precision : [0.01699019 0.01257801 0.01032268 0.00894932 0.00797504]
hit_ratio : [0.28737536 0.39574472 0.46327836 0.5135015  0.55342201]
Epoch:66/150, one epoch(train+test/hour): 0.15827594743834603, training time: 410.9390444755554, testing time: 158.85436344146729
recall    : [0.11824822 0.17308054 0.2130784  0.24488188 0.2721383 ]
ndcg      : [0.06983596 0.08514943 0.09484593 0.10196232 0.10773459]
precision : [0.01710698 0.01259806 0.01036974 0.00895869 0.00798401]
hit_ratio : [0.2885259  0.39665993 0.46475141 0.51418137 0.5535789 ]
Epoch:69/150, one epoch(train+test/hour): 0.15698853135108948, training time: 407.61489629745483, testing time: 157.54381251335144
recall    : [0.11806632 0.1734502  0.21378571 0.24592905 0.27294563]
ndcg      : [0.06992881 0.0854103  0.09518402 0.10237253 0.108098  ]
precision : [0.01707343 0.01262595 0.01040417 0.00899737 0.00800947]
hit_ratio : [0.28815982 0.39669479 0.46605885 0.51529705 0.55404086]
Epoch:72/150, one epoch(train+test/hour): 0.15738198664453296, training time: 407.7773394584656, testing time: 158.79781007766724
recall    : [0.11873323 0.17374363 0.21352003 0.24596971 0.27364341]
ndcg      : [0.070193   0.08555539 0.09522688 0.10246736 0.10830554]
precision : [0.01716713 0.01263663 0.01040069 0.00900042 0.00802158]
hit_ratio : [0.28959801 0.39731365 0.46494317 0.5149484  0.55501708]
