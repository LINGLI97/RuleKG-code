#################### parameter settings ####################
dataset:alibaba-fashion
data_path:data/
load_rules:True
epoch:150
batch_size:1024
test_batch_size:1024
dim:64
l2:1e-05
lr:0.0001
sim_regularity:0.0001
inverse_r:True
node_dropout:True
node_dropout_rate:0.5
mess_dropout:True
mess_dropout_rate:0.1
batch_test_flag:True
channel:64
cuda:True
gpu_id:0
edge_threshold:64
adj_epoch:1
in_channel:[64, 32]
out_channel:[32, 64]
pretrain_s:False
pretrain_r:False
freeze_s:False
k_step:1
num_sample:32
gamma:0.99
Ks:[20, 40, 60, 80, 100]
test_flag:part
n_factors:4
ind:distance
context_hops:3
save:True
out_dir:./weights/
rank:[20, 40, 60, 80, 100]
flag_step:10
#################### experimental settings ####################
0) Model: KGIN
1) recommender: GCN
2) sampler: random sampling
#################### start training ####################
Epoch:0/150, one epoch(train+test/hour): 0.13028440501954822, training time: 323.4968433380127, testing time: 145.52701234817505
recall    : [0.03714539 0.05903446 0.07664738 0.09192535 0.10533308]
ndcg      : [0.02076447 0.02689879 0.03116719 0.03459279 0.03742918]
precision : [0.00549343 0.00437905 0.00378591 0.00341133 0.00312914]
hit_ratio : [0.10335751 0.15908932 0.20055261 0.23550485 0.26503556]
Epoch:1/150, one epoch(train+test/hour): 0.1303322317202886, training time: 320.89096117019653, testing time: 148.30507016181946
recall    : [0.044075   0.07021266 0.09068525 0.10838689 0.12416968]
ndcg      : [0.02503284 0.03232452 0.03727192 0.04123157 0.04457498]
precision : [0.00641474 0.00513083 0.00442351 0.00397527 0.00365238]
hit_ratio : [0.12013632 0.18451468 0.23191374 0.27083188 0.304006  ]
Epoch:2/150, one epoch(train+test/hour): 0.13096740186214448, training time: 322.9272997379303, testing time: 148.55534434318542
recall    : [0.05164335 0.08057857 0.10267864 0.1216427  0.13813014]
ndcg      : [0.02901908 0.03709396 0.04246602 0.04669686 0.05017181]
precision : [0.00750863 0.00588653 0.00502115 0.00446327 0.00405612]
hit_ratio : [0.13917265 0.20861516 0.25813228 0.29810508 0.33094798]
Epoch:3/150, one epoch(train+test/hour): 0.1304505322376887, training time: 321.62557768821716, testing time: 147.9963355064392
recall    : [0.05537386 0.08557621 0.10900686 0.12852179 0.14594009]
ndcg      : [0.03181562 0.04025747 0.04593734 0.05031681 0.05398434]
precision : [0.00804076 0.00625022 0.00532099 0.00471975 0.00428832]
hit_ratio : [0.14797608 0.21994631 0.27128513 0.31140611 0.3457482 ]
Epoch:4/150, one epoch(train+test/hour): 0.12841945535606808, training time: 314.94972348213196, testing time: 147.36031246185303
recall    : [0.05949354 0.09177385 0.11613102 0.13664243 0.15439996]
ndcg      : [0.03490755 0.04390154 0.04979708 0.05436446 0.0581213 ]
precision : [0.00870973 0.00672286 0.00567444 0.00500717 0.00453551]
hit_ratio : [0.15885399 0.23438045 0.2863817  0.32783627 0.36185587]
Epoch:5/150, one epoch(train+test/hour): 0.12892210563023884, training time: 317.21313285827637, testing time: 146.90644526481628
recall    : [0.06295058 0.09576198 0.12107323 0.14205888 0.16031662]
ndcg      : [0.03673348 0.04589807 0.05203018 0.05672571 0.06058989]
precision : [0.00914816 0.00699851 0.00591094 0.00521189 0.00471576]
hit_ratio : [0.16642842 0.24226867 0.29607419 0.3382958  0.37309114]
Epoch:6/150, one epoch(train+test/hour): 0.12962394727600945, training time: 321.8968381881714, testing time: 144.74936938285828
recall    : [0.06618415 0.10033402 0.12663138 0.14808314 0.16725849]
ndcg      : [0.03927412 0.04882243 0.05519864 0.05997997 0.06402856]
precision : [0.00964542 0.0073452  0.00619146 0.00543318 0.00491563]
hit_ratio : [0.17497908 0.25281535 0.30805035 0.34999303 0.3856077 ]
Epoch:7/150, one epoch(train+test/hour): 0.1304176084862815, training time: 322.55658888816833, testing time: 146.9468002319336
recall    : [0.07155785 0.10700924 0.1341569  0.15640041 0.1756154 ]
ndcg      : [0.04226082 0.05216361 0.05874492 0.06371482 0.06776701]
precision : [0.01044209 0.00783091 0.00655928 0.00574304 0.00516238]
hit_ratio : [0.18754794 0.26754585 0.32326023 0.36629245 0.4015236 ]
Epoch:8/150, one epoch(train+test/hour): 0.13067423734400008, training time: 321.8150498867035, testing time: 148.61220288276672
recall    : [0.07545682 0.11315685 0.14164923 0.16489256 0.18471151]
ndcg      : [0.04485563 0.05539884 0.06229759 0.06750138 0.07168435]
precision : [0.01102782 0.00830508 0.00693336 0.00606489 0.00543799]
hit_ratio : [0.19724915 0.28079457 0.33779897 0.38145875 0.41671606]
Epoch:9/150, one epoch(train+test/hour): 0.12997244563367633, training time: 320.98481822013855, testing time: 146.91598296165466
recall    : [0.07978821 0.1186894  0.14785145 0.17157465 0.19192021]
ndcg      : [0.04733872 0.05821693 0.06528932 0.0705851  0.07488148]
precision : [0.01165016 0.00870712 0.00724133 0.00630829 0.0056505 ]
hit_ratio : [0.20678474 0.29261383 0.34996688 0.39411478 0.43012168]
Epoch:10/150, one epoch(train+test/hour): 0.12958602918518913, training time: 320.7757532596588, testing time: 145.73394966125488
recall    : [0.08415778 0.1245458  0.15401272 0.17864725 0.20001066]
ndcg      : [0.0501853  0.06145327 0.06862476 0.07413833 0.07865358]
precision : [0.01229822 0.0091194  0.00755003 0.00657806 0.00589751]
hit_ratio : [0.21709609 0.30377066 0.36194303 0.40700614 0.44337041]
Epoch:11/150, one epoch(train+test/hour): 0.13018953820069631, training time: 322.4811201095581, testing time: 146.20121455192566
recall    : [0.08880862 0.13119368 0.16253372 0.18762227 0.20939496]
ndcg      : [0.05315166 0.06500875 0.07262382 0.0782371  0.08284624]
precision : [0.01298114 0.00962603 0.00797204 0.00691407 0.00618288]
hit_ratio : [0.22704135 0.31755108 0.37800711 0.42229447 0.45843212]
Epoch:12/150, one epoch(train+test/hour): 0.13011053754223717, training time: 321.8243160247803, testing time: 146.5736174583435
recall    : [0.09267097 0.13681496 0.16938352 0.19516958 0.21671402]
ndcg      : [0.05502604 0.06737605 0.0752905  0.0810758  0.08564023]
precision : [0.01351414 0.01002502 0.00829731 0.00719114 0.00639957]
hit_ratio : [0.23593194 0.32869047 0.38988739 0.43563908 0.47119273]
Epoch:13/150, one epoch(train+test/hour): 0.12994500637054443, training time: 319.92493414878845, testing time: 147.87708568572998
recall    : [0.09539766 0.14114265 0.17502404 0.20186643 0.22386616]
ndcg      : [0.05624311 0.06902536 0.07726067 0.08328628 0.08794507]
precision : [0.01387979 0.01032616 0.0085646  0.00743236 0.00660606]
hit_ratio : [0.2415365  0.33719755 0.39962346 0.44673489 0.48235827]
Epoch:14/150, one epoch(train+test/hour): 0.13062548379103342, training time: 322.6682770252228, testing time: 147.5834619998932
recall    : [0.09780853 0.14517568 0.17935536 0.20724244 0.23014122]
ndcg      : [0.05748312 0.07071136 0.07902872 0.08529657 0.09015352]
precision : [0.0142158  0.0106077  0.0087767  0.00763349 0.00679546]
hit_ratio : [0.24687086 0.34469354 0.40849662 0.4555296  0.49193745]
Epoch:15/150, one epoch(train+test/hour): 0.12991693629158868, training time: 319.7482273578644, testing time: 147.9527406692505
recall    : [0.09943971 0.14837094 0.18324682 0.21172957 0.23555548]
ndcg      : [0.05810667 0.07177202 0.08024805 0.08662495 0.09165862]
precision : [0.01443588 0.01083171 0.00895844 0.00778036 0.00693379]
hit_ratio : [0.24993899 0.35082979 0.41492922 0.46323478 0.50036608]
Epoch:16/150, one epoch(train+test/hour): 0.13052358852492438, training time: 320.9663279056549, testing time: 148.91858768463135
recall    : [0.10075217 0.14980343 0.18553034 0.21458859 0.23944534]
ndcg      : [0.05890116 0.07261365 0.08128682 0.0878033  0.0930518 ]
precision : [0.01457796 0.010918   0.0090485  0.00787537 0.00703917]
hit_ratio : [0.25259745 0.35268635 0.41892999 0.46781082 0.50654592]
Epoch:17/150, one epoch(train+test/hour): 0.13110061605771384, training time: 323.0256247520447, testing time: 148.93658995628357
recall    : [0.10210889 0.152065   0.18845679 0.21763803 0.24309547]
ndcg      : [0.05948608 0.07344893 0.08230003 0.08883489 0.09421921]
precision : [0.01477233 0.01107358 0.00919348 0.00798519 0.00714743]
hit_ratio : [0.2558399  0.35769821 0.42395056 0.47289241 0.51252528]
Epoch:18/150, one epoch(train+test/hour): 0.13071418351597255, training time: 322.3942859172821, testing time: 148.17677187919617
recall    : [0.10189794 0.15315851 0.18955939 0.21934209 0.24452137]
ndcg      : [0.05963868 0.07394109 0.08279216 0.08946291 0.09479937]
precision : [0.01476318 0.01114854 0.00924171 0.00804305 0.00718927]
hit_ratio : [0.25582247 0.35960707 0.42591172 0.47576006 0.51493968]
Epoch:19/150, one epoch(train+test/hour): 0.13058944079611037, training time: 322.59973907470703, testing time: 147.52224469184875
recall    : [0.10238671 0.15352063 0.19104683 0.22127892 0.24652501]
ndcg      : [0.05941517 0.07371625 0.08282861 0.08958977 0.09493854]
precision : [0.01480153 0.01117012 0.0093052  0.00810548 0.00724052]
hit_ratio : [0.25651105 0.36012133 0.42876194 0.47879332 0.51812984]
Epoch:20/150, one epoch(train+test/hour): 0.1300557886229621, training time: 320.2836275100708, testing time: 147.91720843315125
recall    : [0.10377772 0.15495852 0.19209689 0.22229927 0.24813778]
ndcg      : [0.06002853 0.07433065 0.08334578 0.09010045 0.09556588]
precision : [0.01498326 0.01127319 0.00935183 0.0081374  0.00728105]
hit_ratio : [0.25923924 0.36360784 0.43032215 0.48049299 0.52065756]
Epoch:21/150, one epoch(train+test/hour): 0.1305350493722492, training time: 321.6349573135376, testing time: 148.29121708869934
recall    : [0.1037744  0.15500319 0.19293153 0.22336289 0.2491533 ]
ndcg      : [0.06042892 0.07473635 0.08392071 0.09073801 0.09620026]
precision : [0.01499721 0.0112782  0.0093803  0.00817368 0.00731173]
hit_ratio : [0.25969249 0.36368628 0.43208284 0.48255875 0.52247054]
Epoch:22/150, one epoch(train+test/hour): 0.13100832872920565, training time: 323.5229787826538, testing time: 148.10700178146362
recall    : [0.10505872 0.15722606 0.19474372 0.22472779 0.25104898]
ndcg      : [0.06126705 0.07582695 0.08492343 0.09164854 0.09720818]
precision : [0.01518635 0.01143117 0.00946877 0.00822423 0.00736071]
hit_ratio : [0.26253399 0.36742556 0.43470644 0.48415382 0.52506799]
Epoch:23/150, one epoch(train+test/hour): 0.13020102441310882, training time: 322.48433113098145, testing time: 146.2393410205841
recall    : [0.10492526 0.15699666 0.19489092 0.22530612 0.25109186]
ndcg      : [0.06107162 0.07560494 0.08478993 0.09159854 0.09706334]
precision : [0.01514713 0.01140676 0.00947081 0.00823764 0.00736368]
hit_ratio : [0.26172338 0.36670211 0.43478488 0.48469423 0.52474548]
Epoch:24/150, one epoch(train+test/hour): 0.13126131852467854, training time: 323.7400851249695, testing time: 148.80065870285034
recall    : [0.10588894 0.15840537 0.19551425 0.22637822 0.25264591]
ndcg      : [0.06160086 0.07625667 0.0852876  0.09219794 0.0977387 ]
precision : [0.01526001 0.01149109 0.00950945 0.00828078 0.00740255]
hit_ratio : [0.26342305 0.36909909 0.43597901 0.4869256  0.52719476]
Epoch:25/150, one epoch(train+test/hour): 0.1298407118850284, training time: 318.8189432621002, testing time: 148.60761642456055
recall    : [0.10685904 0.15875356 0.19690345 0.22723757 0.25290533]
ndcg      : [0.06256737 0.07705898 0.08632451 0.09311488 0.09856185]
precision : [0.01540818 0.01153053 0.00957366 0.00830955 0.00742025]
hit_ratio : [0.26585489 0.36970051 0.43798375 0.48796283 0.52750854]
Epoch:26/150, one epoch(train+test/hour): 0.13044792195161184, training time: 321.93585658073425, testing time: 147.67666101455688
recall    : [0.10688299 0.1589151  0.19667104 0.22794178 0.25410436]
ndcg      : [0.0624746  0.07700695 0.08617343 0.09316794 0.09871787]
precision : [0.015406   0.01152857 0.00955405 0.0083273  0.00744892]
hit_ratio : [0.26568928 0.36977896 0.43835855 0.48988041 0.53005369]
Epoch:27/150, one epoch(train+test/hour): 0.13051722943782806, training time: 321.43902707099915, testing time: 148.42299699783325
recall    : [0.10786959 0.1605794  0.19898551 0.22948204 0.2559523 ]
ndcg      : [0.06316922 0.07788229 0.08719454 0.0940339  0.09963972]
precision : [0.01556159 0.01165801 0.00966591 0.00839213 0.00750636]
hit_ratio : [0.2678422  0.37337006 0.4420804  0.49205948 0.53290391]
Epoch:28/150, one epoch(train+test/hour): 0.1298780314789878, training time: 321.0832839012146, testing time: 146.47762799263
recall    : [0.10831986 0.16146414 0.19969908 0.23087772 0.25705111]
ndcg      : [0.06321413 0.07806514 0.08732704 0.09430911 0.09985575]
precision : [0.01562958 0.01173711 0.00970353 0.00843953 0.00753617]
hit_ratio : [0.26884457 0.37479081 0.44292588 0.49391604 0.53429851]
Epoch:29/150, one epoch(train+test/hour): 0.1303006966246499, training time: 322.86002016067505, testing time: 146.22248601913452
recall    : [0.10899525 0.16176269 0.2002398  0.23139428 0.2578561 ]
ndcg      : [0.06388573 0.07861746 0.08794894 0.09493158 0.10053798]
precision : [0.01572023 0.01174343 0.00972605 0.00845848 0.00756006]
hit_ratio : [0.26984694 0.37554041 0.44420717 0.4948051  0.53516143]
Epoch:30/150, one epoch(train+test/hour): 0.1301753235525555, training time: 321.974591255188, testing time: 146.6565704345703
recall    : [0.10963574 0.16224192 0.20111205 0.23188335 0.25836211]
ndcg      : [0.06423845 0.07892432 0.08833813 0.09524452 0.10085099]
precision : [0.01581349 0.0117759  0.00976338 0.00847908 0.00757627]
hit_ratio : [0.27125026 0.37629001 0.44554076 0.49585106 0.53594589]
