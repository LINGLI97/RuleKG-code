#################### parameter settings ####################
dataset:alibaba-fashion
data_path:data/
load_rules:True
which_rule:5
epoch:500
batch_size:1024
test_batch_size:1024
dim:64
l2:1e-05
lr:0.0001
sim_regularity:0.0001
inverse_r:False
node_dropout:True
node_dropout_rate:0.5
mess_dropout:True
mess_dropout_rate:0.1
batch_test_flag:True
channel:64
cuda:True
gpu_id:0
edge_threshold:64
adj_epoch:1
in_channel:[64, 32]
out_channel:[32, 64]
description:shuttleall
pretrain_s:False
pretrain_r:False
freeze_s:False
k_step:10
num_sample:32
gamma:0.99
Ks:[20, 40, 60, 80, 100]
test_flag:part
n_factors:4
ind:distance
context_hops:3
save:True
out_dir:./weights/
rank:[20, 40, 60, 80, 100]
flag_step:30
#################### experimental settings ####################
0) Model: KGIN
1) recommender: GCN
2) sampler: random sampling
#################### start training ####################
Epoch:0/500, one epoch(train+test/hour): 0.2871652619043986, training time: 868.5292460918427, testing time: 165.2656934261322
recall    : [0.03312369 0.05378543 0.07073924 0.08515955 0.09789642]
ndcg      : [0.01812831 0.02390846 0.02802861 0.03124528 0.03393864]
precision : [0.00485235 0.00396547 0.00348607 0.00314494 0.00289554]
hit_ratio : [0.09216582 0.14526532 0.18692037 0.22028624 0.24864898]
Epoch:10/500, one epoch(train+test/hour): 0.26056845194763606, training time: 728.6243612766266, testing time: 209.4220631122589
recall    : [0.0768562  0.11514708 0.14393871 0.1680502  0.18843051]
ndcg      : [0.04560655 0.05630728 0.06329683 0.06869145 0.07301513]
precision : [0.01123178 0.00845064 0.00706076 0.00619127 0.00556595]
hit_ratio : [0.20048288 0.28425493 0.34266265 0.38754271 0.42439509]
Epoch:20/500, one epoch(train+test/hour): 0.2970931433969074, training time: 860.4224379062653, testing time: 209.11287593841553
recall    : [0.09877837 0.14827983 0.18450226 0.21381811 0.2390095 ]
ndcg      : [0.05733573 0.07119483 0.0800021  0.08657647 0.09191395]
precision : [0.01435003 0.0108474  0.00903383 0.00787471 0.00705434]
hit_ratio : [0.24937243 0.35143121 0.41852904 0.46728785 0.50651977]
Epoch:30/500, one epoch(train+test/hour): 0.19528973632388644, training time: 481.53356432914734, testing time: 221.5094838142395
recall    : [0.10552318 0.15714152 0.19529099 0.22562966 0.25173946]
ndcg      : [0.06156819 0.07601776 0.085287   0.09207969 0.09758244]
precision : [0.01527875 0.01147017 0.00954054 0.00828503 0.00740072]
hit_ratio : [0.26296109 0.36804442 0.43658043 0.48580992 0.5259309 ]
Epoch:40/500, one epoch(train+test/hour): 0.18441521479023829, training time: 482.136399269104, testing time: 181.758371591568
recall    : [0.10953954 0.16194287 0.20080301 0.23263675 0.25916869]
ndcg      : [0.06403795 0.07870439 0.08814969 0.09524861 0.10085792]
precision : [0.01584661 0.01181599 0.00980842 0.00853039 0.00761784]
hit_ratio : [0.27065756 0.37658636 0.44598529 0.49694931 0.53612893]
Epoch:50/500, one epoch(train+test/hour): 0.1813407533698612, training time: 484.4570565223694, testing time: 168.36965322494507
recall    : [0.11242452 0.16615455 0.20511183 0.23682934 0.26338849]
ndcg      : [0.06571569 0.08073591 0.09020895 0.09729653 0.10292122]
precision : [0.01628765 0.01212019 0.01001906 0.00869175 0.00774981]
hit_ratio : [0.27729064 0.38379471 0.45202566 0.5024667  0.54168991]
Epoch:60/500, one epoch(train+test/hour): 0.18582687232229445, training time: 479.8127646446228, testing time: 189.16397404670715
recall    : [0.11458454 0.16828383 0.20775729 0.23968494 0.26645035]
ndcg      : [0.0674859  0.08249136 0.09208829 0.09923145 0.10490164]
precision : [0.01661321 0.01227076 0.01014356 0.00879635 0.00783941]
hit_ratio : [0.28206715 0.38716791 0.45593927 0.50677254 0.5461875 ]
Epoch:70/500, one epoch(train+test/hour): 0.18984108136759864, training time: 481.6090898513794, testing time: 201.81880068778992
recall    : [0.1155302  0.17020165 0.20995978 0.24180527 0.26894395]
ndcg      : [0.06820958 0.08351277 0.09316496 0.10030663 0.10604933]
precision : [0.01671737 0.01241109 0.01024554 0.00887719 0.00791219]
hit_ratio : [0.28345304 0.39045394 0.45892894 0.50939614 0.54911617]
Epoch:80/500, one epoch(train+test/hour): 0.17906124975946214, training time: 480.9451448917389, testing time: 163.67535138130188
recall    : [0.11590468 0.17011716 0.21050606 0.24225217 0.26905405]
ndcg      : [0.06827658 0.08345365 0.09324828 0.10035124 0.10603022]
precision : [0.01680104 0.01242068 0.01027517 0.00888918 0.0079155 ]
hit_ratio : [0.28421135 0.39053239 0.45999233 0.5101283  0.54856705]
Epoch:90/500, one epoch(train+test/hour): 0.17417374034722646, training time: 481.05037331581116, testing time: 145.975088596344
recall    : [0.11681246 0.17203081 0.21181321 0.24443211 0.27123574]
ndcg      : [0.06897868 0.08443199 0.09407731 0.10136679 0.10705432]
precision : [0.01691479 0.01255273 0.01033415 0.00895923 0.0079739 ]
hit_ratio : [0.28596332 0.3935395  0.46177045 0.51234224 0.55162646]
Epoch:100/500, one epoch(train+test/hour): 0.19181576583120558, training time: 484.7956123352051, testing time: 205.74114203453064
recall    : [0.11716508 0.17212444 0.21221375 0.24481857 0.27191628]
ndcg      : [0.06915016 0.08451892 0.09424939 0.10154116 0.10726363]
precision : [0.01697798 0.012556   0.01035347 0.00897558 0.0079868 ]
hit_ratio : [0.28620738 0.39299909 0.46143923 0.51269089 0.55206227]
Epoch:110/500, one epoch(train+test/hour): 0.17444758885436587, training time: 491.18056631088257, testing time: 136.83075165748596
recall    : [0.11713798 0.17241237 0.21272489 0.24423408 0.27166487]
ndcg      : [0.0691901  0.08458089 0.09435304 0.10142762 0.10722735]
precision : [0.01699498 0.01254946 0.01035594 0.00894932 0.00797791]
hit_ratio : [0.286434   0.3932693  0.46243288 0.51165365 0.55126909]
Epoch:120/500, one epoch(train+test/hour): 0.17176142705811395, training time: 483.8243947029114, testing time: 134.5167396068573
recall    : [0.11725444 0.17240925 0.21233844 0.24427564 0.27164699]
ndcg      : [0.06926064 0.08467078 0.09436358 0.10152622 0.10732146]
precision : [0.01698234 0.01255971 0.01035129 0.00895858 0.00798454]
hit_ratio : [0.28598947 0.39303396 0.46160484 0.51150547 0.55135625]
Epoch:130/500, one epoch(train+test/hour): 0.1740318571196662, training time: 485.04271960258484, testing time: 141.47196197509766
recall    : [0.11742028 0.17271906 0.21206434 0.24410543 0.2716696 ]
ndcg      : [0.06918762 0.08463472 0.09418393 0.10135242 0.1071682 ]
precision : [0.01703464 0.01259348 0.01034577 0.00895237 0.00797887]
hit_ratio : [0.28700056 0.39429782 0.46140437 0.51099993 0.5510076 ]
Epoch:140/500, one epoch(train+test/hour): 0.1733818444940779, training time: 480.35222578048706, testing time: 143.82241129875183
recall    : [0.11773071 0.17298998 0.21280938 0.24484632 0.27193508]
ndcg      : [0.069382   0.08482243 0.09447022 0.10166167 0.10737129]
precision : [0.01707996 0.01261898 0.01037367 0.00898342 0.00798802]
hit_ratio : [0.28754097 0.39441985 0.46204937 0.51225507 0.55083328]
Epoch:150/500, one epoch(train+test/hour): 0.17161612729231515, training time: 467.8331923484802, testing time: 149.98486304283142
recall    : [0.11702459 0.17217705 0.21225583 0.24364389 0.27063342]
ndcg      : [0.06873645 0.08414904 0.09386109 0.10089637 0.10660075]
precision : [0.01697929 0.01255883 0.01034868 0.00893374 0.00795124]
hit_ratio : [0.28633812 0.39274632 0.46114288 0.51089534 0.54888083]
Epoch:160/500, one epoch(train+test/hour): 0.17587601708041298, training time: 482.05420875549316, testing time: 151.09945011138916
recall    : [0.11696641 0.17127095 0.21129448 0.24279219 0.26998397]
ndcg      : [0.0686314  0.08380656 0.09352165 0.10057627 0.10632613]
precision : [0.01694878 0.0124854  0.01030234 0.00890084 0.00793137]
hit_ratio : [0.28559724 0.39128199 0.45968726 0.50827174 0.54746008]
Epoch:170/500, one epoch(train+test/hour): 0.17934379160404204, training time: 480.15908551216125, testing time: 165.47856092453003
recall    : [0.11695299 0.17093498 0.2111731  0.24266604 0.27001821]
ndcg      : [0.06863565 0.08372855 0.09349377 0.10054336 0.10633608]
precision : [0.01692786 0.01245533 0.01029493 0.00889343 0.00793329]
hit_ratio : [0.28507426 0.38996583 0.45916428 0.50810613 0.54809637]
Epoch:180/500, one epoch(train+test/hour): 0.18174696193801032, training time: 482.47740864753723, testing time: 171.8116512298584
recall    : [0.11601633 0.17033221 0.2104954  0.24266813 0.26949012]
ndcg      : [0.06799613 0.08318065 0.09290757 0.10011431 0.10578592]
precision : [0.01680322 0.01242046 0.01025295 0.00889059 0.00791272]
hit_ratio : [0.28356635 0.38918137 0.45818806 0.50787079 0.54639669]
Epoch:190/500, one epoch(train+test/hour): 0.18627431154251098, training time: 480.49127316474915, testing time: 190.09624552726746
recall    : [0.11613008 0.17035051 0.21043036 0.2421644  0.26865989]
ndcg      : [0.06800298 0.08315402 0.09285126 0.09996461 0.1055774 ]
precision : [0.01681804 0.01241937 0.01024525 0.00886837 0.00788883]
hit_ratio : [0.28370581 0.38902448 0.45755177 0.50721707 0.54528101]
Epoch:200/500, one epoch(train+test/hour): 0.18532216091950734, training time: 480.23420691490173, testing time: 186.92556881904602
recall    : [0.11557853 0.16957261 0.20929525 0.24139283 0.26805997]
ndcg      : [0.067753   0.08282432 0.09246622 0.09966172 0.10531125]
precision : [0.01673567 0.01234376 0.01019251 0.00884527 0.00787593]
hit_ratio : [0.28220661 0.38738582 0.45591312 0.50554355 0.54415661]
Epoch:210/500, one epoch(train+test/hour): 0.17707041733794743, training time: 477.3583912849426, testing time: 160.0951087474823
recall    : [0.11490754 0.16947659 0.20884384 0.24079775 0.2677464 ]
ndcg      : [0.0673368  0.08256218 0.09212357 0.09927117 0.10496735]
precision : [0.01664459 0.01234441 0.0101806  0.00882184 0.00786111]
hit_ratio : [0.28098633 0.38694129 0.45552088 0.50454989 0.54315424]
Epoch:220/500, one epoch(train+test/hour): 0.23450081805388132, training time: 660.3355860710144, testing time: 183.86735606193542
recall    : [0.11462366 0.16879913 0.2084796  0.24055988 0.26669756]
ndcg      : [0.06702211 0.08215677 0.09179071 0.09896302 0.10450307]
precision : [0.01658967 0.01229059 0.01015881 0.00880833 0.00783026]
hit_ratio : [0.28001883 0.38535493 0.454135   0.50417509 0.54238721]
Epoch:230/500, one epoch(train+test/hour): 0.22681082003646427, training time: 661.2234718799591, testing time: 155.29547786712646
recall    : [0.11450094 0.16835102 0.20805521 0.23964832 0.2663447 ]
ndcg      : [0.06708673 0.08211274 0.09175907 0.09883845 0.10449765]
precision : [0.01658357 0.01225616 0.0101376  0.00878218 0.00782642]
hit_ratio : [0.27997525 0.38462276 0.45369918 0.50287637 0.54201241]
Epoch:240/500, one epoch(train+test/hour): 0.22851002845499252, training time: 665.3252098560333, testing time: 157.31088995933533
recall    : [0.11377632 0.16751688 0.20699202 0.23874499 0.26528714]
ndcg      : [0.06663435 0.08162222 0.09121757 0.09833557 0.10394556]
precision : [0.0164768  0.01218273 0.01008211 0.00874721 0.0077872 ]
hit_ratio : [0.27863294 0.38264417 0.4519908  0.50104595 0.53958929]
early stopping at 240, recall@20:0.1177
training {500} epoches takes {134500.288} seconds,{37.361} hour