#################### parameter settings ####################
dataset:alibaba-fashion
data_path:data/
load_rules:True
which_rules:2
epoch:500
batch_size:1024
test_batch_size:1024
dim:64
l2:1e-05
lr:0.0001
sim_regularity:0.0001
inverse_r:True
node_dropout:True
node_dropout_rate:0.5
mess_dropout:True
mess_dropout_rate:0.1
batch_test_flag:True
channel:64
cuda:True
gpu_id:0
edge_threshold:64
adj_epoch:1
in_channel:[64, 32]
out_channel:[32, 64]
pretrain_s:False
pretrain_r:False
freeze_s:False
k_step:9
num_sample:32
gamma:0.99
Ks:[20, 40, 60, 80, 100]
test_flag:part
n_factors:4
ind:distance
context_hops:3
save:True
out_dir:./weights/
rank:[20, 40, 60, 80, 100]
flag_step:20
#################### experimental settings ####################
0) Model: KGIN
1) recommender: GCN
2) sampler: random sampling
#################### start training ####################
Epoch:0/500, one epoch(train+test/hour): 0.282644757827123, training time: 749.174122095108, testing time: 268.3470022678375
recall    : [0.03751521 0.06013907 0.0777844  0.09301615 0.10672913]
ndcg      : [0.02103058 0.02735028 0.0316319  0.03504258 0.03794162]
precision : [0.00552481 0.00443941 0.00383225 0.00344205 0.00316122]
hit_ratio : [0.10386305 0.1610069  0.20271425 0.23733526 0.26721463]
Epoch:9/500, one epoch(train+test/hour): 0.2879527246289783, training time: 770.1243777275085, testing time: 266.5054256916046
recall    : [0.07936188 0.1183157  0.14657517 0.17025432 0.18996312]
ndcg      : [0.04755687 0.05843303 0.06529724 0.07059917 0.0747777 ]
precision : [0.01157738 0.00865416 0.00716782 0.00625708 0.00559767]
hit_ratio : [0.20567778 0.29083572 0.34717767 0.39196186 0.42677463]
Epoch:18/500, one epoch(train+test/hour): 0.301539307501581, training time: 750.3798086643219, testing time: 335.1616952419281
recall    : [0.10289872 0.15315006 0.18979875 0.21975742 0.24483928]
ndcg      : [0.06025928 0.07432897 0.08321286 0.08991639 0.09520679]
precision : [0.01492051 0.01119169 0.00926801 0.00806723 0.00719772]
hit_ratio : [0.25813228 0.36055714 0.42646085 0.4769629  0.51539293]
Epoch:27/500, one epoch(train+test/hour): 0.2858405794699987, training time: 756.5030410289764, testing time: 272.5230369567871
recall    : [0.10948158 0.16175812 0.20006317 0.23097743 0.25699056]
ndcg      : [0.0640957  0.07871443 0.08800969 0.09493232 0.10042403]
precision : [0.01579126 0.01176522 0.00973535 0.00845336 0.00753626]
hit_ratio : [0.27101492 0.37567115 0.44432048 0.49497071 0.53410676]
Epoch:36/500, one epoch(train+test/hour): 0.28775128960609436, training time: 761.9585733413696, testing time: 273.94606614112854
recall    : [0.11275141 0.16680072 0.20550034 0.23696866 0.26378438]
ndcg      : [0.06648143 0.08156481 0.09097263 0.09802231 0.10369147]
precision : [0.01629463 0.01212171 0.01000279 0.00867988 0.00774284]
hit_ratio : [0.27770902 0.38457918 0.45293215 0.50356495 0.54318911]
Epoch:45/500, one epoch(train+test/hour): 0.38004385001129576, training time: 1108.9743373394012, testing time: 259.183518409729
recall    : [0.11567948 0.17027545 0.20960371 0.24149826 0.26838424]
ndcg      : [0.06829501 0.08354991 0.09311368 0.10023403 0.10591883]
precision : [0.01670952 0.01237732 0.01020588 0.00883394 0.00786966]
hit_ratio : [0.28424622 0.39017502 0.45910327 0.51011087 0.54876752]
Epoch:54/500, one epoch(train+test/hour): 0.3736858007642958, training time: 1098.3207626342773, testing time: 246.9481167793274
recall    : [0.11712899 0.17225711 0.21193541 0.24373763 0.27059658]
ndcg      : [0.06941833 0.08481267 0.09445323 0.10157797 0.10725904]
precision : [0.0169161  0.01252027 0.01031367 0.00892524 0.00794314]
hit_ratio : [0.28677393 0.39354822 0.4628687  0.51303082 0.55217558]
Epoch:63/500, one epoch(train+test/hour): 0.3775987930430306, training time: 1101.714691877365, testing time: 257.64096093177795
recall    : [0.11880421 0.17423003 0.21421073 0.24550748 0.27286603]
ndcg      : [0.07041296 0.08590977 0.09563493 0.10264882 0.10842024]
precision : [0.01713705 0.01266713 0.01043279 0.00899682 0.00800825]
hit_ratio : [0.28944983 0.3976623  0.46709609 0.51543651 0.55482533]
Epoch:72/500, one epoch(train+test/hour): 0.3758352225356632, training time: 1098.088163614273, testing time: 254.91863441467285
recall    : [0.11937073 0.17554961 0.2153477  0.2470798  0.27448051]
ndcg      : [0.07080897 0.08651179 0.09616297 0.10327725 0.10907969]
precision : [0.01725995 0.01278328 0.01048829 0.00905435 0.00806403]
hit_ratio : [0.29131511 0.40037306 0.46789798 0.51727564 0.55696081]
Epoch:81/500, one epoch(train+test/hour): 0.3672066437535816, training time: 1037.4404361248016, testing time: 284.5034782886505
recall    : [0.12014395 0.17597234 0.21594502 0.24828105 0.27581749]
ndcg      : [0.07140118 0.08701998 0.09673471 0.10398115 0.10980796]
precision : [0.01735147 0.01279919 0.01051661 0.00909837 0.00810003]
hit_ratio : [0.29249181 0.40052995 0.46948435 0.51916707 0.55900913]
Epoch:90/500, one epoch(train+test/hour): 0.38794661972257827, training time: 1141.5176796913147, testing time: 255.0901484489441
recall    : [0.12071538 0.17599809 0.21653176 0.24871953 0.27605426]
ndcg      : [0.07166224 0.0871265  0.09699653 0.10421134 0.10999478]
precision : [0.017409   0.01279439 0.01055264 0.00911798 0.00811145]
hit_ratio : [0.29344188 0.40054738 0.4701032  0.51948086 0.55908758]
Epoch:99/500, one epoch(train+test/hour): 0.3883142381906509, training time: 1139.2713952064514, testing time: 258.65985918045044
recall    : [0.12120811 0.17699263 0.21721271 0.24993346 0.2766338 ]
ndcg      : [0.07194521 0.08753773 0.09731793 0.10464338 0.11031127]
precision : [0.01748527 0.01286456 0.01057646 0.00915252 0.00812679]
hit_ratio : [0.2944181  0.40202915 0.47046057 0.52123283 0.55933164]
Epoch:108/500, one epoch(train+test/hour): 0.5282833904027939, training time: 1612.8038427829742, testing time: 289.01635456085205
recall    : [0.12100658 0.17734496 0.21753079 0.25041406 0.27776565]
ndcg      : [0.07204629 0.08779524 0.09756876 0.10493686 0.11071611]
precision : [0.01749704 0.01289768 0.0105984  0.00917997 0.00815764]
hit_ratio : [0.29460986 0.40291821 0.47070462 0.52209574 0.56084827]
Epoch:117/500, one epoch(train+test/hour): 0.4945073085361057, training time: 1570.9450888633728, testing time: 209.28121995925903
recall    : [0.12149811 0.17770366 0.21777608 0.25056824 0.27782214]
ndcg      : [0.07230555 0.08801962 0.09772773 0.10508015 0.11087445]
precision : [0.01757287 0.01292949 0.01059477 0.00917365 0.00816383]
hit_ratio : [0.29578656 0.40369395 0.47082665 0.52112823 0.56063036]
Epoch:126/500, one epoch(train+test/hour): 0.4901818553606669, training time: 1566.169694185257, testing time: 198.4849832057953
recall    : [0.12116164 0.17728802 0.21755238 0.25009657 0.27789396]
ndcg      : [0.07222747 0.08792256 0.09770883 0.10501022 0.11090824]
precision : [0.01751316 0.01289419 0.01059738 0.00916646 0.00816767]
hit_ratio : [0.29487135 0.40252597 0.47080922 0.5207883  0.56033401]
Epoch:135/500, one epoch(train+test/hour): 0.4921342451704873, training time: 1573.4798872470856, testing time: 198.2033932209015
recall    : [0.12161862 0.1773702  0.2179949  0.25077667 0.27773154]
ndcg      : [0.07234988 0.08793045 0.09779246 0.10513561 0.11085439]
precision : [0.01759117 0.01290487 0.010617   0.00918597 0.00816043]
hit_ratio : [0.29575169 0.40317098 0.47120145 0.52150303 0.56031657]
Epoch:144/500, one epoch(train+test/hour): 0.489807616604699, training time: 1561.8416912555695, testing time: 201.4657266139984
recall    : [0.12156403 0.17749018 0.21807494 0.25042988 0.27821748]
ndcg      : [0.07226424 0.08790448 0.09777229 0.1050178  0.11091029]
precision : [0.01756982 0.01291293 0.01062513 0.00917463 0.0081763 ]
hit_ratio : [0.29562966 0.40296179 0.47151524 0.52160763 0.56070009]
Epoch:153/500, one epoch(train+test/hour): 0.49746666053930916, training time: 1577.8482177257538, testing time: 213.03175806999207
recall    : [0.12115994 0.17638574 0.21739545 0.24978927 0.2774337 ]
ndcg      : [0.0718065  0.08727534 0.09723103 0.10449306 0.11035235]
precision : [0.01748701 0.01283427 0.01058431 0.00915099 0.00814971]
hit_ratio : [0.29406073 0.40042535 0.47032982 0.52069242 0.55990691]
Epoch:162/500, one epoch(train+test/hour): 0.5306809271706475, training time: 1595.900633096695, testing time: 314.55070185661316
recall    : [0.12111906 0.17674024 0.217273   0.24995835 0.27753132]
ndcg      : [0.07194278 0.08751886 0.0973632  0.1046866  0.11052399]
precision : [0.01749834 0.01286892 0.0105846  0.00915807 0.00815111]
hit_ratio : [0.29449655 0.40159333 0.47046057 0.52101492 0.56008995]
Epoch:171/500, one epoch(train+test/hour): 0.5006316551234987, training time: 1589.2633128166199, testing time: 213.01064348220825
recall    : [0.12082917 0.1768019  0.21713742 0.24934836 0.27715686]
ndcg      : [0.07179801 0.08745011 0.0972351  0.1044701  0.110362  ]
precision : [0.01747437 0.01286804 0.01057109 0.00913814 0.00814457]
hit_ratio : [0.293991   0.40134056 0.4703734  0.51985566 0.55927934]
Epoch:180/500, one epoch(train+test/hour): 0.5261712869670656, training time: 1590.8648872375488, testing time: 303.3517429828644
recall    : [0.12126715 0.17708942 0.21745558 0.24981975 0.27705841]
ndcg      : [0.07210749 0.0877004  0.09750993 0.10476516 0.11052511]
precision : [0.01752624 0.0128748  0.01058736 0.0091499  0.0081335 ]
hit_ratio : [0.29541176 0.40170665 0.47116659 0.52070114 0.55916603]
Epoch:189/500, one epoch(train+test/hour): 0.4996251536740197, training time: 1588.3594827651978, testing time: 210.29106879234314
recall    : [0.12100811 0.17673602 0.21711378 0.24899306 0.27645772]
ndcg      : [0.07187781 0.08746139 0.09727061 0.10443142 0.11024887]
precision : [0.01747873 0.01285214 0.01056949 0.00912571 0.00812321]
hit_ratio : [0.29418276 0.40138414 0.46936232 0.51887944 0.55812879]
Epoch:198/500, one epoch(train+test/hour): 0.5216850162876977, training time: 1593.8295242786407, testing time: 284.236531496048
recall    : [0.1206327  0.17620759 0.21701314 0.24979375 0.27660541]
ndcg      : [0.07165194 0.08719494 0.09711384 0.10443383 0.11011246]
precision : [0.01744997 0.01282664 0.01057792 0.00914642 0.00812069]
hit_ratio : [0.29368594 0.4005561  0.46966739 0.51909734 0.55724845]
Epoch:207/500, one epoch(train+test/hour): 0.49934139245086245, training time: 1587.1268105506897, testing time: 210.50220036506653
recall    : [0.12027322 0.17591363 0.21651905 0.24912174 0.27597834]
ndcg      : [0.07139576 0.08695745 0.09682109 0.10411953 0.109803  ]
precision : [0.0173907  0.0128103  0.01055133 0.00912746 0.00810613]
hit_ratio : [0.29276201 0.39982393 0.46826407 0.51871383 0.55662088]
Epoch:216/500, one epoch(train+test/hour): 0.514446891480022, training time: 1595.8858106136322, testing time: 256.1229953765869
recall    : [0.12037014 0.17584634 0.21604066 0.24862376 0.27566844]
ndcg      : [0.07122857 0.08674899 0.09651922 0.10381498 0.10953815]
precision : [0.01738547 0.01279722 0.01052475 0.0091097  0.00809515]
hit_ratio : [0.29262255 0.39944913 0.46744474 0.51810369 0.55618506]
Epoch:225/500, one epoch(train+test/hour): 0.49463867876264783, training time: 1574.8401308059692, testing time: 205.85911059379578
recall    : [0.1195911  0.17543785 0.21545246 0.24767403 0.27485649]
ndcg      : [0.07089608 0.08651129 0.09622228 0.10343398 0.10919257]
precision : [0.01729395 0.01277064 0.01049192 0.0090683  0.00806786]
hit_ratio : [0.29111464 0.39889129 0.46579736 0.51602922 0.55455512]
early stopping at 225, recall@20:0.1216
training {500} epoches takes {295301.236} seconds,{82.028} hour