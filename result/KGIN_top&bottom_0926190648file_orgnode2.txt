#################### parameter settings ####################
dataset:alibaba-fashion
data_path:data/
load_rules:True
which_rule:6
epoch:500
batch_size:1024
test_batch_size:1024
dim:64
l2:1e-05
lr:0.0001
sim_regularity:0.0001
inverse_r:True
node_dropout:True
node_dropout_rate:0.5
mess_dropout:True
mess_dropout_rate:0.1
batch_test_flag:True
channel:64
cuda:True
gpu_id:0
edge_threshold:64
adj_epoch:1
in_channel:[64, 32]
out_channel:[32, 64]
description:file_orgnode2
pretrain_s:False
pretrain_r:False
freeze_s:False
k_step:10
num_sample:32
gamma:0.99
Ks:[20, 40, 60, 80, 100]
test_flag:part
n_factors:4
ind:distance
context_hops:3
save:True
out_dir:./weights/
rank:[20, 40, 60, 80, 100]
flag_step:10
#################### experimental settings ####################
0) Model: KGIN
1) recommender: GCN
2) sampler: random sampling
#################### start training ####################
Epoch:0/500, one epoch(train+test/hour): 0.18681881229082745, training time: 518.1935892105103, testing time: 154.35413193702698
recall    : [0.04260052 0.06775118 0.08784165 0.1053739  0.12065735]
ndcg      : [0.02471687 0.03172505 0.03660076 0.04052268 0.04375588]
precision : [0.00624826 0.00496827 0.00430467 0.0038795  0.00355903]
hit_ratio : [0.11661495 0.1782041  0.22485357 0.26337947 0.29600446]
Epoch:10/500, one epoch(train+test/hour): 0.1893476484219233, training time: 525.8927743434906, testing time: 155.75875687599182
recall    : [0.09352068 0.13685508 0.16845024 0.19427718 0.21586714]
ndcg      : [0.05600414 0.06814071 0.07582928 0.08162148 0.0861821 ]
precision : [0.01363617 0.01003199 0.00826259 0.00716412 0.00637255]
hit_ratio : [0.23734398 0.32858587 0.38849278 0.43454954 0.46979813]
Epoch:20/500, one epoch(train+test/hour): 0.19049939539697436, training time: 530.3551597595215, testing time: 155.4426600933075
recall    : [0.10962847 0.1629064  0.20072154 0.23162953 0.25766256]
ndcg      : [0.06434898 0.0792592  0.08841995 0.09533685 0.10084246]
precision : [0.01581175 0.01185151 0.00976164 0.00847199 0.00755238]
hit_ratio : [0.27075343 0.37793738 0.44513109 0.494962   0.5339673 ]
Epoch:30/500, one epoch(train+test/hour): 0.1895514988899231, training time: 527.87034034729, testing time: 154.5150535106659
recall    : [0.11419704 0.16890818 0.20809867 0.23981303 0.26631295]
ndcg      : [0.06725231 0.08251091 0.09203259 0.09911439 0.10474383]
precision : [0.01649205 0.01226139 0.01011872 0.0087629  0.00781004]
hit_ratio : [0.28060282 0.38872812 0.45782198 0.50838505 0.54718988]
Epoch:40/500, one epoch(train+test/hour): 0.18925456053680845, training time: 529.4148187637329, testing time: 151.9015965461731
recall    : [0.11818404 0.17342659 0.21358123 0.2451989  0.27224195]
ndcg      : [0.06999875 0.08542404 0.09516519 0.10225619 0.10797687]
precision : [0.01705469 0.01260154 0.01038384 0.00897111 0.00798654]
hit_ratio : [0.28832543 0.3960585  0.46531797 0.51528833 0.55405829]
Epoch:50/500, one epoch(train+test/hour): 0.18939596010579005, training time: 528.9282999038696, testing time: 152.897155046463
recall    : [0.1199863  0.17565778 0.21603201 0.24886949 0.27635989]
ndcg      : [0.07106154 0.08663136 0.09643672 0.10377167 0.10959742]
precision : [0.01730833 0.01277304 0.01051516 0.00910327 0.00810648]
hit_ratio : [0.29188167 0.40057353 0.46994631 0.52081445 0.56022941]
Epoch:60/500, one epoch(train+test/hour): 0.19062211394309997, training time: 532.9757084846497, testing time: 153.26390027999878
recall    : [0.12159498 0.17787154 0.21817201 0.2506807  0.27847257]
ndcg      : [0.0720199  0.08775031 0.09753551 0.10481467 0.11069525]
precision : [0.01754933 0.01292601 0.01061365 0.00916995 0.00816688]
hit_ratio : [0.29556865 0.403877   0.47264835 0.52315912 0.56218186]
Epoch:70/500, one epoch(train+test/hour): 0.1948146347204844, training time: 547.6827652454376, testing time: 153.6499161720276
recall    : [0.12245913 0.17848838 0.21873393 0.25209042 0.27958935]
ndcg      : [0.07249003 0.08815559 0.09792717 0.10538587 0.11120811]
precision : [0.01765916 0.01297155 0.01064009 0.00921822 0.00819669]
hit_ratio : [0.29710271 0.40502754 0.47403424 0.52482393 0.56367234]
Epoch:80/500, one epoch(train+test/hour): 0.1939580710728963, training time: 544.6000859737396, testing time: 153.64896655082703
recall    : [0.12307508 0.17978102 0.22022492 0.25318254 0.28044817]
ndcg      : [0.07279172 0.08862986 0.09847161 0.1058623  0.11163608]
precision : [0.01774153 0.01305283 0.01071375 0.00926823 0.00822885]
hit_ratio : [0.29794819 0.40707587 0.47545499 0.52617495 0.56430863]
Epoch:90/500, one epoch(train+test/hour): 0.19443237258328333, training time: 547.1379041671753, testing time: 152.8186333179474
recall    : [0.12298107 0.17946919 0.22082693 0.25367267 0.28096429]
ndcg      : [0.07284052 0.08863956 0.09868044 0.10602901 0.11181036]
precision : [0.01773761 0.01304215 0.01074178 0.00927934 0.00824097]
hit_ratio : [0.29829684 0.40616937 0.47590824 0.52585245 0.56489262]
Epoch:100/500, one epoch(train+test/hour): 0.19459524068567488, training time: 546.6661670207977, testing time: 153.8766963481903
recall    : [0.12304567 0.18043051 0.2215993  0.25442726 0.28196629]
ndcg      : [0.0728684  0.08888177 0.09889419 0.10625401 0.11208139]
precision : [0.01775809 0.01309292 0.01077752 0.00930952 0.00827061]
hit_ratio : [0.29809637 0.40758141 0.47698905 0.5273778  0.56623492]
Epoch:110/500, one epoch(train+test/hour): 0.19588828391498989, training time: 548.2837777137756, testing time: 156.91404151916504
recall    : [0.12340149 0.18068893 0.22206929 0.2546586  0.28187553]
ndcg      : [0.07310258 0.08910429 0.09915194 0.10645182 0.11221459]
precision : [0.01779077 0.01311537 0.0107935  0.00931344 0.0082645 ]
hit_ratio : [0.29882853 0.40845304 0.47768635 0.52743881 0.565956  ]
Epoch:120/500, one epoch(train+test/hour): 0.18857827723026277, training time: 525.6066808700562, testing time: 153.27511429786682
recall    : [0.12303925 0.18010951 0.22116947 0.25383374 0.28125771]
ndcg      : [0.07264486 0.08857355 0.09855345 0.10586279 0.11167848]
precision : [0.01774719 0.01307353 0.01075718 0.00928119 0.00824995]
hit_ratio : [0.29775643 0.40694512 0.4756206  0.52568684 0.56447423]
Epoch:130/500, one epoch(train+test/hour): 0.189991774559021, training time: 529.6328682899475, testing time: 154.3375174999237
recall    : [0.12338158 0.18035955 0.22091919 0.2539883  0.28075354]
ndcg      : [0.0727547  0.08867186 0.09856041 0.10594126 0.11162045]
precision : [0.01776027 0.01308443 0.01075094 0.00928413 0.00823304]
hit_ratio : [0.29847117 0.40702357 0.47546371 0.52578272 0.56407329]
Epoch:140/500, one epoch(train+test/hour): 0.19060242427719964, training time: 529.726836681366, testing time: 156.44188785552979
recall    : [0.12301008 0.17970157 0.22097684 0.25383361 0.28075428]
ndcg      : [0.07263811 0.08850545 0.09851986 0.10587758 0.11158973]
precision : [0.01771843 0.01305435 0.01074091 0.00928097 0.00823461]
hit_ratio : [0.29750366 0.40619552 0.47580364 0.52563454 0.56345443]
Epoch:150/500, one epoch(train+test/hour): 0.19100745770666333, training time: 530.2878832817078, testing time: 157.33896279335022
recall    : [0.12225945 0.17896202 0.21992444 0.25288072 0.28016558]
ndcg      : [0.07215058 0.08803285 0.09796525 0.10533972 0.11111787]
precision : [0.01761122 0.01300881 0.01069428 0.00924589 0.0082129 ]
hit_ratio : [0.29580399 0.40459173 0.47359842 0.52486751 0.56276585]
Epoch:160/500, one epoch(train+test/hour): 0.19237140364117092, training time: 538.5528471469879, testing time: 153.98420310020447
recall    : [0.12282732 0.17910015 0.22000884 0.25265529 0.27983985]
ndcg      : [0.07234913 0.08807248 0.09801126 0.10531469 0.11108037]
precision : [0.01768444 0.01299661 0.01069326 0.00923369 0.00820541]
hit_ratio : [0.29702427 0.40440869 0.47357228 0.52364724 0.56272226]
Epoch:170/500, one epoch(train+test/hour): 0.19079656660556793, training time: 532.2736015319824, testing time: 154.59403562545776
recall    : [0.12175599 0.17807694 0.21864219 0.25153004 0.27862691]
ndcg      : [0.07187461 0.08760488 0.09745949 0.10483389 0.11056234]
precision : [0.01752754 0.01291184 0.01062092 0.00919741 0.00816479]
hit_ratio : [0.29456628 0.40209016 0.47103584 0.52150303 0.5603863 ]
Epoch:180/500, one epoch(train+test/hour): 0.1899087381362915, training time: 528.2718529701233, testing time: 155.3996021747589
recall    : [0.12115024 0.17775131 0.21870369 0.25166305 0.27805953]
ndcg      : [0.07150834 0.08730978 0.09723731 0.10462596 0.11022597]
precision : [0.01746697 0.01289855 0.01061772 0.00919446 0.00814893]
hit_ratio : [0.29393871 0.40201171 0.47180287 0.52240953 0.55989819]
Epoch:190/500, one epoch(train+test/hour): 0.1998043668270111, training time: 529.6261806488037, testing time: 189.6695375442505
recall    : [0.12094296 0.17748885 0.21797999 0.2506212  0.27715093]
ndcg      : [0.07129326 0.08708917 0.09690881 0.10421591 0.10983092]
precision : [0.01741292 0.01288025 0.01058431 0.00915284 0.00811546]
hit_ratio : [0.29312809 0.40111394 0.47031239 0.5211631  0.55845129]
Epoch:200/500, one epoch(train+test/hour): 0.1893999104367362, training time: 530.8347291946411, testing time: 151.00494503974915
recall    : [0.12083438 0.17722231 0.21797299 0.24989719 0.27661542]
ndcg      : [0.07095579 0.08669866 0.09659468 0.10374909 0.10940343]
precision : [0.01740508 0.01285584 0.01058867 0.00913421 0.00810622]
hit_ratio : [0.29304965 0.4008786  0.47012935 0.51948086 0.55762325]
Epoch:210/500, one epoch(train+test/hour): 0.1888232649034924, training time: 528.5455424785614, testing time: 151.21820783615112
recall    : [0.11975964 0.17630057 0.21700093 0.24937681 0.27641559]
ndcg      : [0.07034363 0.0861528  0.09602569 0.10327281 0.10899698]
precision : [0.01723773 0.01279548 0.01053782 0.00910894 0.00809471]
hit_ratio : [0.29059166 0.39934454 0.46831637 0.51803396 0.55673419]
early stopping at 210, recall@20:0.1234
training {500} epoches takes {116483.019} seconds,{32.356} hour