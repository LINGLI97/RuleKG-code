#################### parameter settings ####################
dataset:alibaba-fashion
data_path:data/
load_rules:True
which_rule:7
epoch:500
batch_size:1024
test_batch_size:1024
dim:64
l2:1e-05
lr:0.0001
sim_regularity:0.0001
inverse_r:False
node_dropout:True
node_dropout_rate:0.5
mess_dropout:True
mess_dropout_rate:0.1
batch_test_flag:True
channel:64
cuda:True
gpu_id:0
edge_threshold:64
adj_epoch:1
in_channel:[64, 32]
out_channel:[32, 64]
description:changeinver2
pretrain_s:False
pretrain_r:False
freeze_s:False
k_step:10
num_sample:32
gamma:0.99
Ks:[20, 40, 60, 80, 100]
test_flag:part
n_factors:4
ind:distance
context_hops:3
save:True
out_dir:./weights/
rank:[20, 40, 60, 80, 100]
flag_step:30
#################### experimental settings ####################
0) Model: KGIN
1) recommender: GCN
2) sampler: random sampling
#################### start training ####################
Epoch:0/500, one epoch(train+test/hour): 0.19685661435127258, training time: 554.8317425251007, testing time: 153.85206604003906
recall    : [0.03397498 0.05601073 0.07414881 0.09009701 0.10461375]
ndcg      : [0.0192631  0.02541227 0.0298058  0.03336164 0.03642684]
precision : [0.00489288 0.00407594 0.00361115 0.00329671 0.0030683 ]
hit_ratio : [0.09274981 0.1493794  0.19276898 0.22884562 0.26056412]
Epoch:10/500, one epoch(train+test/hour): 0.1952678314844767, training time: 553.6448776721954, testing time: 149.31931233406067
recall    : [0.07861354 0.11743255 0.14742317 0.17177467 0.19245323]
ndcg      : [0.04665437 0.05748953 0.06476008 0.07021254 0.07458448]
precision : [0.01138998 0.00855153 0.00718061 0.00629162 0.00564945]
hit_ratio : [0.2026881  0.28814239 0.3481016  0.39394045 0.43051391]
Epoch:20/500, one epoch(train+test/hour): 0.19100170526239607, training time: 534.4569404125214, testing time: 153.14919567108154
recall    : [0.10328468 0.15496095 0.19201604 0.2225758  0.24765639]
ndcg      : [0.05960134 0.07405342 0.0830762  0.08990806 0.09521961]
precision : [0.01490438 0.01126512 0.00935953 0.00815461 0.00727538]
hit_ratio : [0.25708633 0.36302385 0.43040932 0.48059759 0.51895788]
Epoch:30/500, one epoch(train+test/hour): 0.18777924444940355, training time: 513.3025422096252, testing time: 162.7027349472046
recall    : [0.11081315 0.1635452  0.2020894  0.23319038 0.2590493 ]
ndcg      : [0.06500194 0.07972755 0.0890798  0.09603893 0.10151575]
precision : [0.01599566 0.01188594 0.00983195 0.0085317  0.00759963]
hit_ratio : [0.27315041 0.37894847 0.44703124 0.49657451 0.53523987]
Epoch:40/500, one epoch(train+test/hour): 0.1842989824215571, training time: 509.44892978668213, testing time: 154.02740287780762
recall    : [0.11436321 0.16887598 0.20869867 0.24009599 0.26648788]
ndcg      : [0.06709313 0.08232665 0.09199676 0.09902234 0.10461823]
precision : [0.01649859 0.01228057 0.01016128 0.00879014 0.00782564]
hit_ratio : [0.28010599 0.38818771 0.45755177 0.50743498 0.54606548]
Epoch:50/500, one epoch(train+test/hour): 0.1928961894247267, training time: 538.4573001861572, testing time: 155.96897864341736
recall    : [0.11669371 0.17192372 0.21176789 0.2432568  0.27046206]
ndcg      : [0.0684403  0.08385169 0.09349348 0.10056549 0.10629919]
precision : [0.01687687 0.01251002 0.01029406 0.00890519 0.00792675]
hit_ratio : [0.28590231 0.39413221 0.46242417 0.51147933 0.55117321]
Epoch:60/500, one epoch(train+test/hour): 0.19387112597624462, training time: 539.5326480865479, testing time: 158.40340185165405
recall    : [0.11913547 0.1743272  0.21420526 0.24642733 0.27361271]
ndcg      : [0.07020947 0.08564523 0.09533978 0.10254307 0.10829484]
precision : [0.01718412 0.01267716 0.01043018 0.0090185  0.00802611]
hit_ratio : [0.29039119 0.39783662 0.46623318 0.51609895 0.55537445]
Epoch:70/500, one epoch(train+test/hour): 0.19456145935588412, training time: 541.2256031036377, testing time: 159.19564723968506
recall    : [0.11928362 0.17525908 0.21645757 0.24908165 0.27592505]
ndcg      : [0.07046931 0.08609633 0.09606994 0.10336268 0.10904677]
precision : [0.01726998 0.01275691 0.01052925 0.00910687 0.00809009]
hit_ratio : [0.29103619 0.39911791 0.46969354 0.52039607 0.55858204]
Epoch:80/500, one epoch(train+test/hour): 0.19131120761235554, training time: 533.963561296463, testing time: 154.75678277015686
recall    : [0.12076785 0.17722302 0.2175931  0.25025397 0.27737664]
ndcg      : [0.07140781 0.08714924 0.0969601  0.10426717 0.11000475]
precision : [0.01747873 0.01288286 0.0105968  0.00916352 0.00814038]
hit_ratio : [0.29449655 0.40287463 0.47121017 0.52201729 0.56028171]
Epoch:90/500, one epoch(train+test/hour): 0.19357017391257816, training time: 540.6507816314697, testing time: 156.20184063911438
recall    : [0.12142114 0.17797264 0.21890459 0.25124978 0.27880336]
ndcg      : [0.07184925 0.08764444 0.09757622 0.1048234  0.110645  ]
precision : [0.017555   0.01294845 0.01065288 0.00919893 0.00817891]
hit_ratio : [0.29533331 0.40324071 0.4729447  0.52277561 0.56170246]
Epoch:100/500, one epoch(train+test/hour): 0.1933020755317476, training time: 538.7042083740234, testing time: 157.18325972557068
recall    : [0.12166925 0.17813447 0.21911611 0.25168738 0.27928287]
ndcg      : [0.07199545 0.08775023 0.09768498 0.10495391 0.11080781]
precision : [0.01761776 0.01296654 0.01066624 0.0092034  0.00819233]
hit_ratio : [0.29588243 0.40405132 0.47311031 0.52342061 0.56246078]
Epoch:110/500, one epoch(train+test/hour): 0.1918146981133355, training time: 538.0663888454437, testing time: 152.46652221679688
recall    : [0.12215155 0.17900347 0.21973579 0.25253717 0.27986676]
ndcg      : [0.07225485 0.08813437 0.09801748 0.10535589 0.11113125]
precision : [0.01766482 0.01302385 0.01069704 0.00924229 0.00820889]
hit_ratio : [0.29678893 0.40571613 0.47407782 0.52481522 0.56345443]
Epoch:120/500, one epoch(train+test/hour): 0.19374194741249084, training time: 539.0398716926575, testing time: 158.43113565444946
recall    : [0.1227484  0.17925124 0.22020233 0.25278348 0.28023275]
ndcg      : [0.07261562 0.08840692 0.09832945 0.10562708 0.1114377 ]
precision : [0.01773238 0.01303867 0.01070953 0.00924829 0.00821979]
hit_ratio : [0.29799177 0.4060212  0.47468796 0.52471062 0.56406457]
Epoch:130/500, one epoch(train+test/hour): 0.19354547182718912, training time: 537.8889820575714, testing time: 158.8747136592865
recall    : [0.12251077 0.17950056 0.22026219 0.2523562  0.28001488]
ndcg      : [0.07250845 0.08842182 0.09830257 0.10550693 0.11136096]
precision : [0.017701   0.01304825 0.01071142 0.00923728 0.00821656]
hit_ratio : [0.29765184 0.40584687 0.47467924 0.5241615  0.56290531]
Epoch:140/500, one epoch(train+test/hour): 0.1926708686351776, training time: 536.2750158309937, testing time: 157.34010863304138
recall    : [0.12258148 0.17931512 0.22057869 0.25280493 0.27983907]
ndcg      : [0.0725495  0.08837542 0.09840438 0.10563408 0.11137124]
precision : [0.01770405 0.01302472 0.01073176 0.00925755 0.00822057]
hit_ratio : [0.29680636 0.40482707 0.47500174 0.52464961 0.56307963]
Epoch:150/500, one epoch(train+test/hour): 0.18856984423266518, training time: 514.5605363845825, testing time: 164.2909004688263
recall    : [0.12283506 0.17882463 0.22006112 0.25250763 0.28030944]
ndcg      : [0.07262112 0.08827449 0.09828226 0.10556394 0.11143572]
precision : [0.01770753 0.01299574 0.01070387 0.0092436  0.0082224 ]
hit_ratio : [0.29695454 0.40460916 0.47425214 0.52457988 0.56366362]
Epoch:160/500, one epoch(train+test/hour): 0.18536649902661642, training time: 508.6353268623352, testing time: 158.68406701087952
recall    : [0.12274141 0.17960201 0.22069334 0.25329421 0.28036652]
ndcg      : [0.07266741 0.08854848 0.09854247 0.10586325 0.11159933]
precision : [0.01767833 0.01303213 0.01073394 0.00927618 0.00823252]
hit_ratio : [0.29669305 0.40543721 0.47493201 0.525129   0.56401227]
Epoch:170/500, one epoch(train+test/hour): 0.18436155729823642, training time: 506.71324348449707, testing time: 156.9883599281311
recall    : [0.12194735 0.17829906 0.21962612 0.25158413 0.27890941]
ndcg      : [0.07219616 0.08793079 0.0979674  0.10514342 0.11092798]
precision : [0.01758681 0.01294039 0.01067539 0.00920776 0.00818431]
hit_ratio : [0.29507182 0.40303152 0.472997   0.52264486 0.56110976]
Epoch:180/500, one epoch(train+test/hour): 0.1837337503830592, training time: 506.53571105003357, testing time: 154.90578818321228
recall    : [0.12159737 0.17740161 0.21871774 0.25095114 0.27792984]
ndcg      : [0.0716173  0.0872076  0.09723965 0.10447889 0.11020411]
precision : [0.01750575 0.01287001 0.0106276  0.00918237 0.00815668]
hit_ratio : [0.29428736 0.40104421 0.47166341 0.52138101 0.55954954]
Epoch:190/500, one epoch(train+test/hour): 0.1843296339114507, training time: 508.36230516433716, testing time: 155.22437381744385
recall    : [0.12139313 0.17835468 0.21902075 0.25130671 0.27850548]
ndcg      : [0.07166813 0.08758085 0.09746668 0.10470258 0.11046525]
precision : [0.01748396 0.01294475 0.01065172 0.00919708 0.00817316]
hit_ratio : [0.29364235 0.40332787 0.47209923 0.52235723 0.56128408]
Epoch:200/500, one epoch(train+test/hour): 0.19109747144911024, training time: 534.5892505645752, testing time: 153.36164355278015
recall    : [0.12074934 0.17696694 0.21799331 0.25035298 0.27761393]
ndcg      : [0.07129232 0.08700659 0.09697012 0.10422068 0.11001156]
precision : [0.01738111 0.01284386 0.01059462 0.00915557 0.00814762]
hit_ratio : [0.29228262 0.40025974 0.47005962 0.52076215 0.55992434]
Epoch:210/500, one epoch(train+test/hour): 0.19203752941555446, training time: 541.3006856441498, testing time: 150.03441786766052
recall    : [0.12042336 0.17656796 0.21751406 0.2498431  0.27681724]
ndcg      : [0.07099999 0.08669353 0.09663818 0.10388918 0.10958973]
precision : [0.01733012 0.01281335 0.01057065 0.0091413  0.00811554]
hit_ratio : [0.29175964 0.39964961 0.4694059  0.51977721 0.55852974]
Epoch:220/500, one epoch(train+test/hour): 0.19179850631290013, training time: 540.0868985652924, testing time: 150.38772082328796
recall    : [0.12024234 0.17600395 0.21715701 0.24947683 0.27692504]
ndcg      : [0.070964   0.08654803 0.09652579 0.10378086 0.10957649]
precision : [0.01731574 0.01277914 0.01054915 0.00912637 0.00811685]
hit_ratio : [0.29162018 0.39840318 0.46845583 0.51843491 0.55826825]
Epoch:230/500, one epoch(train+test/hour): 0.19183232201470268, training time: 540.179527759552, testing time: 150.41682767868042
recall    : [0.11968016 0.1757207  0.21682785 0.24875538 0.27580246]
ndcg      : [0.07057077 0.08624231 0.09622153 0.10338136 0.10910532]
precision : [0.01722596 0.01275255 0.01053622 0.00909793 0.00808678]
hit_ratio : [0.2903476  0.39833345 0.46830765 0.51792065 0.55723102]
Epoch:240/500, one epoch(train+test/hour): 0.1946102621820238, training time: 549.7482461929321, testing time: 150.848694562912
recall    : [0.11959384 0.17474994 0.21594775 0.24809343 0.27505759]
ndcg      : [0.07041976 0.08585473 0.09585677 0.1030605  0.10876224]
precision : [0.0171911  0.01268348 0.01049598 0.00907374 0.00806325]
hit_ratio : [0.2900774  0.39641587 0.46621575 0.51675267 0.55536573]
Epoch:250/500, one epoch(train+test/hour): 0.14867293741967944, training time: 395.526447057724, testing time: 139.6961236000061
recall    : [0.11937612 0.17452311 0.2150082  0.24696241 0.27393894]
ndcg      : [0.07022594 0.08562119 0.09547899 0.10262622 0.10832702]
precision : [0.01716974 0.0126473  0.01045211 0.00902711 0.00802472]
hit_ratio : [0.28941496 0.39594519 0.46504777 0.5145213  0.55404086]
early stopping at 250, recall@20:0.1228
training {500} epoches takes {137147.234} seconds,{38.096} hour