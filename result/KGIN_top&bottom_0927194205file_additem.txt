#################### parameter settings ####################
dataset:alibaba-fashion
data_path:data/
load_rules:True
which_rule:6
epoch:500
batch_size:1024
test_batch_size:1024
dim:64
l2:1e-05
lr:0.0001
sim_regularity:0.0001
inverse_r:True
node_dropout:True
node_dropout_rate:0.5
mess_dropout:True
mess_dropout_rate:0.1
batch_test_flag:True
channel:64
cuda:True
gpu_id:0
edge_threshold:64
adj_epoch:1
in_channel:[64, 32]
out_channel:[32, 64]
description:file_additem
pretrain_s:False
pretrain_r:False
freeze_s:False
k_step:10
num_sample:32
gamma:0.99
Ks:[20, 40, 60, 80, 100]
test_flag:part
n_factors:4
ind:distance
context_hops:3
save:True
out_dir:./weights/
rank:[20, 40, 60, 80, 100]
flag_step:10
#################### experimental settings ####################
0) Model: KGIN
1) recommender: GCN
2) sampler: random sampling
#################### start training ####################
Epoch:0/500, one epoch(train+test/hour): 0.14987985796398587, training time: 386.79149174690247, testing time: 152.77599382400513
recall    : [0.04395145 0.0695453  0.08982553 0.10689511 0.12179922]
ndcg      : [0.02559628 0.03274597 0.03766583 0.04149192 0.04464611]
precision : [0.00642127 0.00510185 0.00440244 0.00393932 0.00359555]
hit_ratio : [0.11967436 0.18287602 0.22918555 0.26654348 0.29799177]
Epoch:10/500, one epoch(train+test/hour): 0.1520651169617971, training time: 393.85992765426636, testing time: 153.57449007034302
recall    : [0.09108247 0.13349715 0.16452821 0.1891529  0.21073932]
ndcg      : [0.05475933 0.06661673 0.07413555 0.07965309 0.08422267]
precision : [0.01329928 0.00977529 0.00804453 0.00695504 0.00620755]
hit_ratio : [0.23249773 0.32244962 0.38162436 0.42559794 0.46166585]
Epoch:20/500, one epoch(train+test/hour): 0.1529661378595564, training time: 396.8952054977417, testing time: 153.78288745880127
recall    : [0.10908574 0.16148116 0.20052121 0.23098459 0.25669799]
ndcg      : [0.06394883 0.0785679  0.08803669 0.09485254 0.10029173]
precision : [0.01577383 0.01174713 0.00975873 0.00845118 0.00752903]
hit_ratio : [0.2701433  0.37500872 0.44439021 0.49388118 0.53294749]
Epoch:30/500, one epoch(train+test/hour): 0.1519913054174847, training time: 394.22198390960693, testing time: 152.94671320915222
recall    : [0.11354919 0.16811383 0.20751384 0.23905871 0.26581695]
ndcg      : [0.06683015 0.08205235 0.09162183 0.09867594 0.10434628]
precision : [0.01639879 0.01220517 0.01008734 0.00873948 0.00779409]
hit_ratio : [0.27931281 0.38728122 0.45620075 0.5064849  0.54551635]
Epoch:40/500, one epoch(train+test/hour): 0.16001568833986918, training time: 391.8498501777649, testing time: 184.2066252231598
recall    : [0.11766662 0.17314411 0.21275615 0.24417818 0.27080714]
ndcg      : [0.06964882 0.08512998 0.09474831 0.10177532 0.1074204 ]
precision : [0.01698496 0.01257649 0.01034432 0.00892622 0.00794226]
hit_ratio : [0.28734049 0.39618053 0.46381877 0.51300467 0.5525068 ]
Epoch:50/500, one epoch(train+test/hour): 0.15312285549110838, training time: 400.6106116771698, testing time: 150.63166522979736
recall    : [0.12001402 0.17483303 0.21541529 0.24822861 0.27538976]
ndcg      : [0.07107475 0.0863925  0.09623658 0.10356912 0.109314  ]
precision : [0.0173567  0.0127203  0.0104848  0.00908213 0.00807658]
hit_ratio : [0.29257025 0.39972805 0.46871731 0.51952444 0.55837285]
Epoch:60/500, one epoch(train+test/hour): 0.15231827371650272, training time: 397.21841835975647, testing time: 151.1273636817932
recall    : [0.12068184 0.17691395 0.21708549 0.24949875 0.27694187]
ndcg      : [0.07169143 0.08738971 0.09715289 0.1044108  0.11021999]
precision : [0.01745738 0.01286652 0.01057065 0.00913596 0.00812966]
hit_ratio : [0.29386898 0.40206401 0.47070462 0.52080573 0.5593665 ]
Epoch:70/500, one epoch(train+test/hour): 0.1523673329088423, training time: 399.6569814682007, testing time: 148.86541414260864
recall    : [0.12188665 0.17808831 0.2183416  0.25090948 0.2783537 ]
ndcg      : [0.07220287 0.08791123 0.09768607 0.10498002 0.11079421]
precision : [0.01757592 0.01293298 0.0106199  0.00918041 0.00816801]
hit_ratio : [0.29549892 0.40363294 0.47216024 0.52299352 0.56260895]
Epoch:80/500, one epoch(train+test/hour): 0.15468342906898921, training time: 415.39055919647217, testing time: 141.46978330612183
recall    : [0.12195694 0.17908113 0.21891449 0.25156179 0.27956062]
ndcg      : [0.07217598 0.08810471 0.09780744 0.1051115  0.11104639]
precision : [0.01760599 0.01299596 0.01065201 0.00920362 0.00820358]
hit_ratio : [0.29595217 0.40508856 0.47279653 0.52328987 0.56334112]
Epoch:90/500, one epoch(train+test/hour): 0.1512435452143351, training time: 402.970810174942, testing time: 141.50594925880432
recall    : [0.12251465 0.17887473 0.21996571 0.25245865 0.28000325]
ndcg      : [0.07280624 0.0885147  0.09850352 0.10577654 0.1116012 ]
precision : [0.01769054 0.01298223 0.01069573 0.00923282 0.00820898]
hit_ratio : [0.29714629 0.40503626 0.47405167 0.52465832 0.56385538]
Epoch:100/500, one epoch(train+test/hour): 0.1508387455675337, training time: 401.7690677642822, testing time: 141.250412940979
recall    : [0.12263188 0.17969102 0.22037754 0.25320491 0.28083268]
ndcg      : [0.07280787 0.08873933 0.09862647 0.10598347 0.11182946]
precision : [0.01768879 0.01304825 0.01071665 0.00926637 0.00823914]
hit_ratio : [0.29725961 0.40598633 0.47464438 0.5254515  0.56479674]
Epoch:110/500, one epoch(train+test/hour): 0.15135441223780313, training time: 402.44655084609985, testing time: 142.42932963371277
recall    : [0.12268717 0.17920466 0.21965581 0.25273595 0.28025206]
ndcg      : [0.07274186 0.08850761 0.09835511 0.10575207 0.11157467]
precision : [0.01769969 0.01299399 0.01068019 0.00923968 0.00821473]
hit_ratio : [0.29672791 0.40526288 0.47358099 0.52430967 0.56405585]
Epoch:120/500, one epoch(train+test/hour): 0.1596720192167494, training time: 399.9146018028259, testing time: 174.90466451644897
recall    : [0.12254643 0.17918857 0.22038022 0.25308789 0.28109616]
ndcg      : [0.07250344 0.08829581 0.098302   0.10563287 0.11156218]
precision : [0.01768618 0.0129977  0.01070561 0.00925265 0.00824114]
hit_ratio : [0.2966669  0.40521059 0.47510634 0.52537306 0.56458755]
Epoch:130/500, one epoch(train+test/hour): 0.15531838337580364, training time: 383.9316461086273, testing time: 175.21453213691711
recall    : [0.12249049 0.17865087 0.21970957 0.25257992 0.27960791]
ndcg      : [0.07246742 0.08814113 0.09812156 0.10547695 0.11120606]
precision : [0.01766352 0.01295869 0.01067612 0.00923314 0.00819939]
hit_ratio : [0.2962921  0.40368524 0.47324977 0.52379541 0.56172861]
Epoch:140/500, one epoch(train+test/hour): 0.15421220375431907, training time: 378.6095492839813, testing time: 176.55438137054443
recall    : [0.12241653 0.17862037 0.21942591 0.25212448 0.27978101]
ndcg      : [0.07229248 0.08798113 0.09787606 0.10520765 0.11105954]
precision : [0.01765611 0.01296174 0.01065448 0.00921506 0.00820018]
hit_ratio : [0.29603061 0.40331915 0.47298829 0.52327244 0.56227774]
Epoch:150/500, one epoch(train+test/hour): 0.15388212786780464, training time: 377.0748941898346, testing time: 176.9007625579834
recall    : [0.12176265 0.17856144 0.21880093 0.25172453 0.27946284]
ndcg      : [0.07212834 0.08795882 0.09774936 0.10511684 0.11099482]
precision : [0.01758202 0.01295259 0.0106369  0.0092059  0.00819748]
hit_ratio : [0.29520257 0.4030228  0.47205564 0.5221306  0.56205983]
Epoch:160/500, one epoch(train+test/hour): 0.13999765965673658, training time: 348.2680172920227, testing time: 155.7235541343689
recall    : [0.12147434 0.17753506 0.21829816 0.25062047 0.27811724]
ndcg      : [0.07191248 0.0875705  0.09746161 0.10470793 0.11051778]
precision : [0.01754193 0.01289659 0.01060973 0.00916614 0.00815198]
hit_ratio : [0.29451398 0.40153232 0.47092253 0.52043093 0.55969772]
Epoch:170/500, one epoch(train+test/hour): 0.144894687599606, training time: 355.6516110897064, testing time: 165.96926069259644
recall    : [0.12092907 0.17666991 0.21718547 0.24973686 0.27681436]
ndcg      : [0.07131156 0.08686128 0.09668005 0.10397671 0.10971476]
precision : [0.01744605 0.01281684 0.01054291 0.00912539 0.00811223]
hit_ratio : [0.29343316 0.3994317  0.46829022 0.51873998 0.55723102]
Epoch:180/500, one epoch(train+test/hour): 0.1375395053625107, training time: 367.96576976776123, testing time: 127.17644762992859
recall    : [0.12059374 0.17691414 0.21734492 0.24994169 0.27682427]
ndcg      : [0.07136321 0.08706748 0.09687891 0.10418069 0.10989347]
precision : [0.01742033 0.01283514 0.01055656 0.00913367 0.00811929]
hit_ratio : [0.29281431 0.39951015 0.46797643 0.5192891  0.5574925 ]
Epoch:190/500, one epoch(train+test/hour): 0.13838793012830947, training time: 369.0708920955658, testing time: 129.12565445899963
recall    : [0.11995287 0.17602495 0.2161239  0.24847181 0.27581142]
ndcg      : [0.07080681 0.08645824 0.09618847 0.10343317 0.10922466]
precision : [0.01731269 0.01277282 0.01049526 0.00907745 0.00808233]
hit_ratio : [0.29163761 0.39821142 0.46674744 0.51670909 0.55599331]
Epoch:200/500, one epoch(train+test/hour): 0.13782377084096273, training time: 368.92141032218933, testing time: 127.24416279792786
recall    : [0.11998996 0.17577034 0.21627639 0.24868356 0.27552463]
ndcg      : [0.0708807  0.08644878 0.09628706 0.10354454 0.10922569]
precision : [0.01732576 0.01275757 0.01051269 0.00909139 0.00807728]
hit_ratio : [0.29168119 0.39768845 0.46712224 0.517572   0.55477303]
Epoch:210/500, one epoch(train+test/hour): 0.13888387276066674, training time: 367.9452543258667, testing time: 132.03668594360352
recall    : [0.11926753 0.17460866 0.21465139 0.24708296 0.27477867]
ndcg      : [0.07026973 0.08570359 0.09543522 0.10269444 0.10853804]
precision : [0.01721289 0.0126691  0.01043454 0.00903441 0.00804939]
hit_ratio : [0.2900251  0.39596262 0.46401925 0.51423367 0.5534743 ]
early stopping at 210, recall@20:0.1227
training {500} epoches takes {84721.379} seconds,{23.534} hour