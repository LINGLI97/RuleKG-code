#################### parameter settings ####################
dataset:alibaba-fashion
data_path:data/
epoch:150
batch_size:1024
test_batch_size:1024
dim:64
l2:1e-05
lr:0.0001
sim_regularity:0.0001
inverse_r:True
node_dropout:True
node_dropout_rate:0.5
mess_dropout:True
mess_dropout_rate:0.1
batch_test_flag:True
channel:64
cuda:True
gpu_id:0
edge_threshold:64
adj_epoch:1
in_channel:[64, 32]
out_channel:[32, 64]
pretrain_s:False
pretrain_r:False
freeze_s:False
k_step:1
num_sample:32
gamma:0.99
Ks:[20, 40, 60, 80, 100]
test_flag:part
n_factors:4
ind:distance
context_hops:3
save:True
out_dir:./weights/
rank:[20, 40, 60, 80, 100]
flag_step:10
#################### experimental settings ####################
0) Model: KGIN
1) recommender: GCN
2) sampler: random sampling
#################### start training ####################
Epoch:0/150, one epoch(train+test/hour): 0.3864692944288254, training time: 1217.593845129013, testing time: 173.69560146331787
recall    : [0.03906879 0.06205797 0.08078653 0.09728211 0.11132504]
ndcg      : [0.02308386 0.02950727 0.0340561  0.03773755 0.04071127]
precision : [0.00565947 0.0045329  0.00394861 0.00356888 0.00327505]
hit_ratio : [0.1064605  0.16415348 0.20909455 0.24643505 0.27671536]
Epoch:1/150, one epoch(train+test/hour): 0.6102349154154459, training time: 2016.8713393211365, testing time: 179.97435402870178
recall    : [0.0485432  0.07577542 0.09646812 0.11452975 0.13098242]
ndcg      : [0.02848595 0.03608445 0.04111367 0.04514116 0.04860648]
precision : [0.00698827 0.00549561 0.00469153 0.00418326 0.00383132]
hit_ratio : [0.13001185 0.19602015 0.24290496 0.28185796 0.31596472]
Epoch:2/150, one epoch(train+test/hour): 0.6013048369354672, training time: 2011.4996581077576, testing time: 153.19775247573853
recall    : [0.05410155 0.08274436 0.10648826 0.12610533 0.1435405 ]
ndcg      : [0.03220025 0.04019345 0.04591415 0.05028096 0.05396128]
precision : [0.00782721 0.0060188  0.00516381 0.0045902  0.00418791]
hit_ratio : [0.14430653 0.21278154 0.26519246 0.30641169 0.34122446]
Epoch:3/150, one epoch(train+test/hour): 0.6069392510255178, training time: 2023.245233297348, testing time: 161.73606848716736
recall    : [0.05924947 0.09029156 0.115183   0.13560704 0.15341223]
ndcg      : [0.03509062 0.043744   0.04976696 0.05431213 0.0580637 ]
precision : [0.00855981 0.00656444 0.00559468 0.00494223 0.00447912]
hit_ratio : [0.15751168 0.2302838  0.28416777 0.32596228 0.36039153]
Epoch:4/150, one epoch(train+test/hour): 0.6063216989570194, training time: 2018.8658394813538, testing time: 163.89227437973022
recall    : [0.06442939 0.09753016 0.12292844 0.14438205 0.162676  ]
ndcg      : [0.03862735 0.04787058 0.05402529 0.05882132 0.06267855]
precision : [0.0093068  0.00709548 0.00597718 0.00527716 0.00476257]
hit_ratio : [0.16949655 0.24636532 0.30037131 0.34350812 0.37810299]
Epoch:5/150, one epoch(train+test/hour): 0.6118766026364433, training time: 2027.4294202327728, testing time: 175.32634687423706
recall    : [0.06904117 0.10417551 0.13099283 0.15300299 0.17219942]
ndcg      : [0.04148395 0.05126888 0.05778544 0.06270152 0.06675212]
precision : [0.01002894 0.00758446 0.0063851  0.00560314 0.00504968]
hit_ratio : [0.18186493 0.26085175 0.31757723 0.3600516  0.39470748]
Epoch:6/150, one epoch(train+test/hour): 0.608630370563931, training time: 2007.4569017887115, testing time: 183.61242270469666
recall    : [0.07540969 0.11234074 0.13985186 0.16275848 0.18258014]
ndcg      : [0.04532796 0.05564239 0.06228513 0.06741813 0.07159981]
precision : [0.01096594 0.00820441 0.00681147 0.00596236 0.00535667]
hit_ratio : [0.19650826 0.27905132 0.33448679 0.37841678 0.41424064]
Epoch:7/150, one epoch(train+test/hour): 0.6195694944593642, training time: 2021.570321559906, testing time: 208.8798542022705
recall    : [0.08103154 0.11997249 0.14896665 0.17300311 0.19271498]
ndcg      : [0.04842141 0.05931214 0.06634125 0.07171274 0.07587036]
precision : [0.01181272 0.00878774 0.00728549 0.00635568 0.00566932]
hit_ratio : [0.21008821 0.29482777 0.35307859 0.39779304 0.43186493]
Epoch:8/150, one epoch(train+test/hour): 0.6008087970150842, training time: 1991.6295926570892, testing time: 171.28207421302795
recall    : [0.08733046 0.12779186 0.15781646 0.18163856 0.20234781]
ndcg      : [0.05216088 0.06347508 0.07076222 0.07611209 0.08048394]
precision : [0.01268914 0.00933905 0.00770954 0.0066771  0.005956  ]
hit_ratio : [0.22354613 0.31040374 0.36952618 0.41360435 0.44910571]
Epoch:9/150, one epoch(train+test/hour): 0.6012256922324498, training time: 2003.7222440242767, testing time: 160.69024443626404
recall    : [0.09250864 0.1346602  0.16586267 0.19117503 0.21231667]
ndcg      : [0.05499998 0.06681057 0.07440192 0.08007386 0.08454904]
precision : [0.01343656 0.00985614 0.00812138 0.00703632 0.00626299]
hit_ratio : [0.23502545 0.32487274 0.38468377 0.43022627 0.46539642]
Epoch:10/150, one epoch(train+test/hour): 0.6042229659689797, training time: 2017.6258985996246, testing time: 157.57675647735596
recall    : [0.09562028 0.13952654 0.17179303 0.19823145 0.2210137 ]
ndcg      : [0.05617349 0.0684875  0.0763315  0.08224609 0.08706363]
precision : [0.01388937 0.01021547 0.00841381 0.00729345 0.00651219]
hit_ratio : [0.24178928 0.33464368 0.39602364 0.44236804 0.47971724]
Epoch:11/150, one epoch(train+test/hour): 0.6037452948755688, training time: 2016.298880815506, testing time: 157.1841790676117
recall    : [0.09819253 0.14488961 0.17818797 0.20571658 0.22905146]
ndcg      : [0.05750997 0.07060096 0.07869642 0.08486655 0.08980657]
precision : [0.01422582 0.01058525 0.00871409 0.00756332 0.00674918]
hit_ratio : [0.2467837  0.34468482 0.407041   0.45450108 0.49203333]
Epoch:12/150, one epoch(train+test/hour): 0.6056829912794961, training time: 2017.2792460918427, testing time: 163.17952013015747
recall    : [0.10071439 0.14818204 0.1830676  0.21111062 0.23495703]
ndcg      : [0.05888278 0.07216388 0.08061626 0.08691287 0.09197277]
precision : [0.01459321 0.01081776 0.008932   0.00775214 0.00691828]
hit_ratio : [0.25301583 0.35072519 0.41538247 0.46333938 0.50108082]
Epoch:13/150, one epoch(train+test/hour): 0.6067719215816921, training time: 2012.3720636367798, testing time: 172.00685167312622
recall    : [0.10152624 0.14963039 0.18497515 0.21407111 0.23862079]
ndcg      : [0.05970045 0.07311794 0.08171436 0.08824009 0.09344019]
precision : [0.0147148  0.01089468 0.0090209  0.00785554 0.00702104]
hit_ratio : [0.25453246 0.35327034 0.41878181 0.46812461 0.50660693]
Epoch:14/150, one epoch(train+test/hour): 0.5840301322937012, training time: 1937.3015110492706, testing time: 165.20696020126343
recall    : [0.10216394 0.15144715 0.18793483 0.21735693 0.24184327]
ndcg      : [0.05959811 0.07338685 0.08223114 0.08882942 0.09401544]
precision : [0.01476492 0.0110324  0.00915629 0.00796721 0.00710716]
hit_ratio : [0.25524719 0.35656509 0.42374137 0.4734241  0.51136601]
Epoch:15/150, one epoch(train+test/hour): 0.5958431590927972, training time: 1980.2303049564362, testing time: 164.8050570487976
recall    : [0.10275005 0.15262982 0.18956557 0.21875864 0.24385165]
ndcg      : [0.05974653 0.07369301 0.08265409 0.08918771 0.09450482]
precision : [0.01482899 0.011103   0.00922428 0.00800622 0.0071578 ]
hit_ratio : [0.25650234 0.35909281 0.4256851  0.47503661 0.51428596]
Epoch:16/150, one epoch(train+test/hour): 0.5997771045234468, training time: 1988.8218376636505, testing time: 170.37572646141052
recall    : [0.10318301 0.15351626 0.19110447 0.22100472 0.24605376]
ndcg      : [0.06026183 0.07433316 0.08343225 0.09011599 0.09541512]
precision : [0.01488128 0.01116881 0.00929169 0.00807758 0.00720975]
hit_ratio : [0.25759187 0.36064431 0.42882296 0.47864514 0.51735409]
Epoch:17/150, one epoch(train+test/hour): 0.5975672640403111, training time: 1986.1827902793884, testing time: 165.05935764312744
recall    : [0.10319805 0.15405977 0.1911133  0.22131909 0.24699723]
ndcg      : [0.0602459  0.07444583 0.08344681 0.09018711 0.09561973]
precision : [0.01488434 0.01119365 0.00929648 0.00808772 0.00723686]
hit_ratio : [0.25761802 0.36153337 0.42867478 0.47949934 0.51927167]
Epoch:18/150, one epoch(train+test/hour): 0.5999253792232937, training time: 1943.2848489284515, testing time: 216.4465148448944
recall    : [0.10371518 0.15507534 0.19242103 0.2234649  0.24893856]
ndcg      : [0.06058883 0.07492954 0.0839909  0.09091993 0.09632141]
precision : [0.01494753 0.0112551  0.00935227 0.00816235 0.0072956 ]
hit_ratio : [0.25911722 0.36380831 0.43142912 0.482428   0.52236594]
Epoch:19/150, one epoch(train+test/hour): 0.6050381512112087, training time: 2013.2760872840881, testing time: 164.8612539768219
recall    : [0.10463014 0.15594921 0.19335751 0.22387039 0.24958438]
ndcg      : [0.06128749 0.075609   0.08467796 0.09150053 0.09694351]
precision : [0.01509701 0.01132265 0.00939323 0.00817782 0.00731112]
hit_ratio : [0.26102608 0.36486298 0.43203926 0.48358727 0.52321142]
Epoch:20/150, one epoch(train+test/hour): 0.5976605148447884, training time: 1983.6940114498138, testing time: 167.8838391304016
recall    : [0.10490374 0.15708869 0.19477988 0.22577777 0.25122615]
ndcg      : [0.06142254 0.07595935 0.08510284 0.09202523 0.09740858]
precision : [0.01514277 0.01139325 0.00945889 0.00824265 0.00735208]
hit_ratio : [0.26171466 0.36673698 0.43492434 0.48640262 0.52562583]
